YUI.add("breakout",function(c){function b(f,e,d){return Math.max(Math.min(f,d),e)}function a(d){var f=d.rows,e=d.columns;this._host=d.host;this._container=c.Node.create("<div style='position: absolute'>");this._nodes=[];if(!(f||e)){f=8}this._rows=f;this._columns=e;a.superclass.constructor.apply(this,arguments)}a.NS="breakout";a.Name="Breakout";c.extend(a,c.Plugin.Base,{_splitNode:function(){var d,i,k,j,g=Math.round(this._blockWidth),m=Math.round(this._blockHeight),q=this._rows,h=this._columns,l=this._host.getXY(),n,f=this._container,e=this._nodes=[],p,o=c.Node.create('<div style="width: '+g+"px; height: "+m+'px; position: absolute; overflow: hidden">');f.setXY(l);for(d=0;d<q;d++){e[d]=p=[];j=d*m;for(i=0;i<h;i++){k=i*g;n=this._host.cloneNode(true);p[i]=o.cloneNode().setXY([k,j]).append(n.setXY([-k,-j]));f.append(p[i])}}this._swapIn()},_swapIn:function(){this._host.get("parentNode").append(this._container);this._host.setStyle("visibility","hidden")},_setup:function(){if(this._nodes.length){return}var g=this._host,f=parseFloat(g.getComputedStyle("width")),d=parseFloat(g.getComputedStyle("height")),i,j,h=this._rows,e=this._columns;if(h){j=d/h}if(e){i=f/e}if(!h){j=i;h=d/j}if(!e){i=j;e=f/i}this._container.setStyles({width:f,height:d});this._width=f;this._height=d;this._blockWidth=i;this._blockHeight=j;this._rows=h;this._columns=e;this._splitNode()},_forEach:function(o,p){this._setup();this._swapIn();var d,l,n=this._rows,g=this._columns,p=p||{},f=Math.abs(p.random||0),j=0,h,m,i,e=this._container,k=this;p.crop&&e.setStyle("overflow","hidden");for(d=0;d<n;d++){for(l=0;l<g;l++){j++;m=this._nodes[d][l];h=o.call(this,m,d,l,n,g);i=d+l;if(p.reverse){i=n+g-i}h.animation.on("end",function(){j--;if(!j){k._container.remove();p.unhide&&k._host.setStyle("visibility","visible");p.crop&&e.setStyle("overflow","visible");k.fire("end")}});(function(q){var t=1-(Math.random()*f),r;if(p.fade){r=p.unhide?0:1;c.mix(q.animation.get("from"),{opacity:r});c.mix(q.animation.get("to"),{opacity:1-r})}else{m.setStyle("opacity",1)}setTimeout(function(){q.animation.run()},q.interval*i*t)})(h)}}},explode:function(d){d=d||{};if(!("fade" in d)){d.fade=true}var e=Math.abs(d.random||0);this._forEach(function(i,p,j,q,k){var g=(d.distance||1.5)*2,l=d.duration||1000,m=d.easing||c.Easing.easeOutStrong,h=1-(Math.random()*e),f={x:(k-1)/2,y:(q-1)/2},o={x:j-f.x,y:p-f.y},n;g*=h;n={left:(o.x*g+f.x)*this._blockWidth,top:(o.y*g+f.y)*this._blockHeight};if(d.unhide){i.setStyles(n);n={left:j*this._blockWidth,top:p*this._blockHeight}}anim=new c.Anim({node:i,easing:m,to:n,duration:l/1000});return{animation:anim,interval:0}},d)},sheer:function(e){e=e||{};var h=e.distance||1,f=e.duration||1000,d=e.interval||0,g=e.easing||c.Easing.easeIn;this._forEach(function(j,r,k,t,l){var p=!(k%2),m=!(r%2),i=this._width,q=this._height,o={left:k*this._blockWidth,top:r*this._blockHeight},n={};if(l===1){p=m}if(t===1){m=!p}if(p){if(m){n.left=o.left-h*i}else{n.top=o.top+h*q}}else{if(m){n.top=o.top-h*q}else{n.left=o.left+h*i}}if(e.unhide){n=o}anim=new c.Anim({node:j,easing:g,to:n,duration:f/1000});return{animation:anim,interval:d}},e)},pinwheel:function(d){d=d||{};var g=d.distance||1,e=d.duration||1000,f=d.easing||c.Easing.easeOut;this._forEach(function(j,r,k,t,l){var p=!(k%2),m=!(r%2),i=0,h=this._blockWidth,q=this._blockHeight,o={left:k*h,top:r*q,width:h,height:q},n={};if(p){if(m){n.top=o.top+g*q}else{n.left=o.left+g*h}}if(p===m){n.height=q*(1-g)}else{n.width=h*(1-g)}if(d.unhide){n=o}anim=new c.Anim({node:j,easing:f,to:n,duration:e/1000});return{animation:anim,interval:i}},d)},disintegrate:function(d){d=d||{};d.reverse=true;this._forEach(function(g,n,h,o,i){var e=(d.distance||1.5)*this._height,k=d.duration||1000,l=d.easing||c.Easing.easeBoth,f=k/(o+i)*2,m=n*this._blockHeight,j;if(e<0){n=o-n-1}if(d.unhide){g.setStyle("top",m-e)}else{m+=e}j=new c.Anim({node:g,easing:l,to:{top:m},duration:k/1000});return{animation:j,interval:f}},d)},fadeOut:function(d){d=d||{};d.fade=true;this._forEach(function(f,l,g,m,h){var j=d.duration||700,n=d.unhide?0:1,k=d.easing,e,i;if(!k){k=d.unhide?c.Easing.easeOut:c.Easing.easeInStrong}e=j/(m+h)*2;i=new c.Anim({node:f,easing:k,from:{},to:{},duration:j/1000});return{animation:i,interval:e}},d)},_inverse:function(e,d){d=d||{};d.unhide=true;e.call(this,d)},unsheer:function(d){this._inverse(this.sheer,d)},unpinwheel:function(d){this._inverse(this.pinwheel,d)},converge:function(d){this._inverse(this.explode,d)},fadeIn:function(d){this._inverse(this.fadeOut,d)},build:function(d){this._inverse(this.disintegrate,d)}});c.Breakout=a},"1.0",{requires:["plugin","anim"]});if(!Array.prototype.indexOf){Array.prototype.indexOf=function(b){var a=this.length>>>0;var c=Number(arguments[1])||0;c=(c<0)?Math.ceil(c):Math.floor(c);if(c<0){c+=a}for(;c<a;c++){if(c in this&&this[c]===b){return c}}return -1}}Array.prototype.flatten=function(){var b=[],c,a,e,d=Array.prototype;for(c=0,a=this.length;c<a;c++){e=this[c];if(Object.prototype.toString.call(e)==="[object Array]"){d.push.apply(b,d.flatten.call(e))}else{b.push(e)}}return b};function argsArray(a){return Array.prototype.slice.call(a)}Array.prototype.last=function(){return this[this.length-1]};Array.prototype.deleteItem=function(b){var a=this.indexOf(b);a!==-1&&this.splice(a,1)};Array.prototype.shuffle=function(){var b=this.length,d,c,a;while(--b){d=~~(Math.random()*b);c=this[b];a=this[d];this[d]=c;this[b]=a}};Function.prototype.bind=function(b){var a=this;return function(){var c=argsArray(arguments);return a.apply(b,c)}};Function.prototype.partial=function(){var b=this,a=argsArray(arguments);return function(){var e,c,d=[].concat(a);for(e=0,c=arguments.length;e<c;e++){d.push(arguments[e])}return b.apply(this,d)}};function instance(c,b){var a=new Function(),e,d;a.prototype=c;e=new a;if(typeof b==="object"){for(d in b){if(b.hasOwnProperty(d)){e[d]=b[d]}}}return e}function normalize(a){var b=typeof a==="function"?a():a;return isNaN(b)?undefined:b}Object.prototype.mapToFloat=function(){var a;for(a in this){if(this.hasOwnProperty(a)){this[a]=parseFloat(this[a])}}return this};Object.prototype.mapAppend=function(b){var a;for(a in this){if(this.hasOwnProperty(a)){this[a]+=b}}return this};var Game;YUI.add("solitaire",function(d){var b=d.namespace("Solitaire");function a(e){a.superclass.constructor.call(this,e)}d.extend(a,d.DD.Delegate,{getCard:function(){return this.get("currentNode").getData("target")}});d.mix(b,{activeCard:null,moves:null,selector:"body",offset:{left:50,top:70},padding:{x:50,y:50},widthScale:0,noop:function(){},name:function(){var e;for(e in b){if(b.hasOwnProperty(e)&&b[e]===Game){return e}}},container:function(){return d.one(b.selector)},width:function(){return this.Card.base.width*this.widthScale},height:function(){return this.Card.base.height*4.2},maxStackHeight:function(){return b.Application.windowHeight-normalize(this.Tableau.stackConfig.layout.top)-b.offset.top},undo:function(){d.fire("undo")},pushMove:function(f){var e=b.moves;e&&e.push(f)},serialize:function(){var j=[],k=[],h,g,f,e;d.Array.each(this.fields,function(i){g=this[i.toLowerCase()].stacks;for(f=0,e=g.length;f<e;f++){h=g[f].serialize();j.push(h);k.push(String.fromCharCode(h.length))}},this);return[String.fromCharCode(j.length)].concat(k,j).join("")},stationary:function(f){var e=Game.Card.updatePosition;Game.Card.updatePosition=b.noop;f.call(this);Game.Card.updatePosition=e},unanimated:function(g){var f=d.Solitaire.Animation,e=f.animate;f.animate=false;g.call(this);f.animate=e},unserialize:function(e){this.unanimated(function(){var f=e.charCodeAt(0),j=e.substr(1,f),k=f+1,m,n=this.fields,q=-1,h=[],p,o,l,g;for(l=0,p=0;l<f;l++,p++,k+=g){g=j.charCodeAt(l);m=e.substr(k,g);if(p===h.length){q++;h=this[n[q].toLowerCase()].stacks;p=0}o=h[p];o.unserialize(m);o.updateCardsPosition()}})},save:function(e){var f=this.serialize(),e=e||"saved-game",g=1206900000;d.Cookie.set(e,f,{expires:new Date(new Date().getTime()+g)})},loadGame:function(e){this.unanimated(function(){this.setup(function(){this.unserialize(e)})});d.fire("loadGame")},newGame:function(){d.Cookie.remove("saved-game");this.setup(this.deal);Game.save("initial-game");d.fire("newGame")},cleanup:function(){d.Event.purgeElement(this.container());d.detach("solitaire|*");this.eachStack(function(e){e.cleanup()})},setup:function(e){Game=b.game=this;d.fire("beforeSetup");b.moves=null;c.clear();this.stationary(function(){this.init();d.Solitaire.Animation.initQueue();this.createStacks();this.createEvents();this.createDraggables();e.call(this)});b.moves=[];d.fire("afterSetup");d.Solitaire.Animation.dealing=true;Game.eachStack(function(f){f.updateCardsStyle();f.updateCardsPosition()});d.Solitaire.Animation.dealing=false},createEvents:function(){var e=d.one(b.selector);e.delegate("dblclick",Game.autoPlay,".card");e.delegate("contextmenu",Game.autoPlay,".card");e.delegate("click",Game.Events.click,".card");e.delegate("touchend",Game.Events.click,".card");d.on("solitaire|endTurn",Game.Events.endTurn);d.on("solitaire|undo",Game.Events.undo)},createDraggables:function(){var e=new a({dragConfig:{dragMode:"intersect",groups:["open"],clickPixelThresh:0},container:b.selector,nodes:".card"});e.dd.plug(d.Plugin.DDProxy,{borderStyle:"none",moveOnEnd:false});e.on("drag:drag",Game.Events.drag);e.on("drag:mouseDown",Game.Events.dragCheck);e.on("drag:start",Game.Events.dragStart);e.on("drag:dropmiss",Game.Events.dragMiss);e.on("drag:drophit",Game.Events.drop);e.on("drag:end",Game.Events.dragEnd)},createField:function(l){if(!l){return}var k=instance(l),m,g,j,h,e;if(l.stackConfig){m=l.stackConfig.layout;j=new Array(l.stackConfig.total);l.Stack.field=l.field;for(h=0,e=j.length;h<e;h++){g=instance(l.Stack);g.configLayout=m;g.layout(d.merge(m,{hoffset:h*m.hspacing||0,voffset:h*m.vspacing||0}),h);j[h]=g}}k.stacks=j;typeof k.init==="function"&&k.init();return k},createStacks:function(){this.eachStack(function(e){e.cards=[];e.createNode()})},eachStack:function(f,e){Game&&d.Array.each(Game.fields,function(h){var g=h.toLowerCase(),i=Game[g],j=e||g;j===g&&i.stacks&&d.Array.each(i.stacks,f)})},resize:function(e){d.fire("beforeResize");this.scale(e);this.unanimated(function(){this.eachStack(function(f,g){var j=f.cards,h=f.configLayout;f.adjustRankHeight();f.cards=[];f.layout(d.merge(h,{hoffset:g*h.hspacing||0,voffset:g*h.vspacing||0}),g);f.updateStyle();f.setCards(j.length,function(l){var k=j[l];k&&k.updateStyle();return k});f.update()})});d.fire("afterResize")},scale:function(g){var e=d.Solitaire.Card,f=e.base,h;e.scale=g;for(h in f){if(f.hasOwnProperty(h)){e[h]=f[h]*g}}},init:function(){var g=b.preventDefault,f,h,e;d.on("selectstart",g,document);d.on("mousedown",g,document.body);d.on("contextmenu",function(j){var i=j.target;if(i.hasClass("stack")||i.hasClass("card")){j.preventDefault()}},document);this.scale(1);e=d.Array.map(Game.fields,function(i){return Game[i.toLowerCase()]=Game.createField(Game[i])});if(Game.fields.indexOf("Deck"===-1)){Game.deck=Game.createField(Game.Deck)}f=Math.min.apply(Math,d.Array.map(e,function(i){return d.Array.map(i.stacks,function(j){return j.left})}).flatten());h=Math.max.apply(Math,d.Array.map(e,function(i){return d.Array.map(i.stacks,function(j){return j.left})}).flatten())+this.Card.width;this.widthScale=(h-f)/this.Card.base.width},preventDefault:function(f){f.preventDefault()},autoPlay:function(){var e=typeof this.getCard==="function"?this.getCard():this.getData("target");e.autoPlay()},isWon:function(){var k=this.foundation.stacks,f=this.deck,h,j=0,g,e;h=f.suits.length*13*f.count;for(g=0,e=k.length;g<e;g++){j+=k[g].cards.length}return j===h},win:function(){d.fire("win");d.Cookie.remove("saved-game")},endTurn:function(){d.fire("endTurn")}});d.Solitaire.Events={click:function(g){var f=g.target.getData("target");if(f.dragging){return}f.dragging=false;f.turnOver(g);b.moves.reverse();b.endTurn();g.preventDefault()},clickEmptyDeck:function(){Game.redeal();b.moves.reverse();b.endTurn()},drag:function(){this.getCard().dragging=true},dragCheck:function(){var f=this.getCard(),e=f.createProxyStack();if(!e){return}b.activeCard=f;Game.eachStack(function(g){g.updateDragGroups()})},dragStart:function(){var e=this.getCard(),g=this.get("dragNode"),f=e.createProxyNode();if(f){g.setContent(f);!e.proxyStack&&d.one(".yui3-dd-shim").setStyle("cursor","not-allowed")}},dragMiss:function(){var e=this.getCard();Game.unanimated(function(){e.updatePosition()})},dragEnd:function(){var j=this.getCard(),m=b.container(),k=new d.Node(document.createDocumentFragment()),g,h,i=this.dd.realXY,n=m.getXY(),e,l,f=j.proxyStack;j.dragging=false;g=this.get("dragNode");h=g.get("firstChild");h&&h.remove();if(!f){return}e=f.cards;l=j.stack;f.left=i[0]-n[0];f.top=i[1]-n[1];Game.unanimated(function(){f.updateCardsPosition()});d.Array.each(e,function(o){if(!o){return}o.proxyStack=null;k.append(o.node)});m.append(k);l.updateCardsPosition()},drop:function(j){if(!b.activeCard){return}var h=b.activeCard,f=h.proxyStack,g=h.stack,i,k;if(f){k=f.first();i=j.drop.get("node").getData("target");i=i.stack||i;if((f.cards.length===1&&k.validTarget(i))||f.validTarget(i)){i.pushStack(f)}}b.endTurn()},endTurn:function(){b.moves.length&&c.push(b.moves);b.moves=[];b.activeCard=null;Game.eachStack(function(e){e.updateCardsStyle()});if(Game.isWon()){Game.win()}else{Game.save()}},undo:function(){var e=argsArray(arguments);e.unshift("endTurn");c.undo();d.fire.apply(d,e)}};d.Solitaire.Deck={count:1,suits:["c","d","h","s"],init:function(f){var g=this.suits,j,h,k,i,e=Game.Card;this.cards=[];for(i=0;i<this.count;i++){for(k=1;k<=13;k++){for(h=0;j=g[h];h++){this.cards.push(e.create(k,j).faceDown())}}}if(f===undefined){this.cards.shuffle()}else{this.msSeededShuffle(f)}},msSeededShuffle:function(e){var k=this.cards,g=Math.pow(2,31),j,f,h;for(h=k.length;h>1;h--){e=((214013*e)%g+2531011)%g;j=(e>>16)&32767;item=k[h-1];f=k[j%h];k[h-1]=f;k[j%h]=item}},createStack:function(){var e;for(e=this.cards.length-1;e>=0;e--){this.stacks[0].push(this.cards[e])}},last:function(){return this.cards.last()},pop:function(){return this.cards.pop()}};d.Solitaire.Card={zIndex:1,index:-1,width:null,height:null,rankHeight:null,hiddenRankHeight:null,isFaceDown:false,positioned:false,scale:1,stack:null,proxyStack:null,ghost:true,dragging:false,node:null,callback:null,left:0,top:0,base:{},origin:{left:function(){var e=b.container().getXY()[0];return -e-d.Solitaire.Card.width},top:function(){var e=b.container().getXY()[1];return -e-d.Solitaire.Card.height}},animSpeeds:{slow:0.5,mid:0.2,fast:0.1},create:function(g,f){var e={c:0,s:0,h:1,d:1};return instance(this,{rank:g,suit:f,color:e[f]})},truncatePosition:function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top)},faceDown:function(e){this.isFaceDown=true;this.setRankHeight();this.setImageSrc();e||b.pushMove({card:this,faceDown:true});return this},faceUp:function(e){this.isFaceDown=false;this.setRankHeight();this.setImageSrc();e||b.pushMove({card:this,faceDown:false});return this},setRankHeight:function(){var e=this.stack,f,g;if(e&&e.rankHeight){f=e.rankHeight;g=e.hiddenRankHeight}else{f=b.Card.rankHeight;g=b.Card.hiddenRankHeight}this.rankHeight=this.isFaceDown?g:f},imageSrc:function(){var e=this.base.theme+"/";e+=this.isFaceDown?"facedown":this.suit+this.rank;e+=".png";return e},setImageSrc:function(){var e=this.node;e&&e.setAttribute("src",this.imageSrc())},wrapperStyle:function(){return{left:this.left,top:this.top,width:Math.floor(this.width),height:Math.floor(this.height)}},updateStyle:function(){var e=this.node;e&&e.setStyles(this.wrapperStyle());this.setRankHeight()},turnOver:function(g){if(!this.isFaceDown){return}var f=this.stack;if(f.field==="deck"){Game.turnOver()}else{if(this.isFree()){this.faceUp()}}g.stopPropagation()},autoPlay:function(){var f=this.stack,k=f.last(),j,g,h,e;if(this.isFaceDown||f.field==="foundation"){return}j=Game.foundation.stacks;for(h=0,e=j.length;h<e;h++){g=j[h];if(this.isFree()&&this.validTarget(g)){this.moveTo(g);f.updateCardsPosition();f.update();b.endTurn();return true}}return false},ensureDOM:function(){!this.node&&this.createNode()},isFree:function(){return this===this.stack.last()},playable:function(){return this.stack.field==="deck"||(this.isFree()&&(this.stack.field!=="foundation"))},createNode:function(){var e,g,f=this;g=this.node=d.Node.create("<img class='card'>").setData("target",this).setAttribute("src",this.imageSrc()).plug(d.Plugin.Drop,{useShim:false});g.setStyles({left:-this.width,top:-this.height});this.setRankHeight();b.container().append(g)},destroyNode:function(){var e=this.node;e&&e.clearData().destroy(true)},createProxyStack:function(){if(this.isFaceDown||this.stack.field==="foundation"){this.proxyStack=null;return null}var f=instance(this.stack,{proxy:true,stack:this.stack}),j=f.cards,g,h,e;f.cards=[];f.push(this,true);for(h=j.indexOf(this)+1,e=j.length;h<e;h++){g=j[h];if(f.validProxy(g)){f.push(g,true)}else{break}}this.proxyStack=h===e?f:null;return this.proxyStack},proxyCards:function(){return this.proxyStack.cards},createProxyNode:function(){var f=d.Node.create("<div>"),e=this.proxyStack;if(!e){if(!this.ghost){return null}f.setStyles({opacity:0.6,top:-this.top,left:-this.left}).append(this.node.cloneNode(true))}else{f.setStyles({opacity:1,top:-this.top,left:-this.left});d.Array.each(this.proxyCards(),function(g){g.proxyStack=e;f.append(g.node)})}return f},updatePosition:function(e){if(!this.node){return}var g={left:this.left+"px",top:this.top+"px",zIndex:this.zIndex},f=this.origin;if(!this.positioned){this.node.setStyles({left:normalize(f.left),top:normalize(f.top)})}d.Solitaire.Animation.init(this,g,e)},pushPosition:function(){var e=this.index>=0?this.index:this.stack.cards.indexOf(this);b.pushMove({card:this,index:e,from:this.stack})},moveTo:function(e){var f=this.stack;this.pushPosition();f.deleteItem(this);e.push(this);d.fire(f.field+":afterPop",f);return this},after:function(e){this.callback=e},runCallback:function(){if(this.callback){this.callback.call(this);this.callback=null}}};d.Solitaire.Stack={cards:null,node:null,images:{tableau:"freeslot.png",deck:"freeslot.png",reserve:"freeslot.png",foundation:"freeslot.png"},serialize:function(){var h,e,k=this.cards,g,f=Game.deck.suits,l,j=[];for(h=0,e=k.length;h<e;h++){g=k[h];if(g){l=f.indexOf(g.suit)|g.rank<<2|g.isFaceDown<<6}else{l=128}j.push(String.fromCharCode(l))}return j.join("")},eachCard:function(h){var f,e,g=this.cards;for(f=0,e=g.length;f<e;f++){if(g[f]){if(h.call(this,g[f],f)===false){return false}}}return true},setCards:function(j,f){var h,e,g,l,k=instance(Game.Card,{updatePosition:b.noop,ensureDOM:b.noop});l=this.cards=[];for(h=0;h<j;h++){g=f.call(this,h)||k;this.push(g)}for(h=0;h<j;h++){if(l[h]===k){l[h]=null}}},updateCardsPosition:function(){var e=this.cards;Game.stationary(function(){this.proxy||this.adjustRankHeight();this.setCards(e.length,function(g){var f=e[g];if(f){f.stack=this;f.setRankHeight()}return f})}.bind(this));this.eachCard(function(f){f.updatePosition()})},updateCardsStyle:function(){var e=this.field;e==="foundation"||this.eachCard(function(f){if(f.playable()){f.node.addClass("playable")}else{f.node.removeClass("playable")}})},unserialize:function(g){var f=Game.deck,e=Game.Card;this.setCards(g.length,function(j){var k,h;k=g.charCodeAt(j);if(k===128){h=null}else{h=e.create((k>>2)&15,f.suits[k&3]);k&64?h.faceDown(true):h.faceUp(true)}return h});this.update()},imageSrc:function(){var e=this.images[this.field];return e?b.Card.base.theme+"/"+e:"trans.gif"},layout:function(i){var h=i.hoffset*d.Solitaire.Card.width,f=i.voffset*d.Solitaire.Card.height,g=b.offset,e=this;d.Array.each(["top","left"],function(j){e[j]=normalize(i[j])});this.left+=h+g.left;this.top+=f+g.top},deleteItem:function(e){this.cards.deleteItem(e)},push:function(f,e){var g=this.last(),i=this.field,h=f.stack?f.stack.field:"deck";if(g){f.zIndex=g.zIndex+1}else{if(i==="deck"||i==="foundation"){f.zIndex=200}else{if(h==="deck"){f.zIndex=Game.Card.zIndex}}}if(!e){f.stack=this;this.setCardPosition(f);f.truncatePosition();f.ensureDOM()}this.cards.push(f);e||f.updatePosition({from:h,to:i})},pushStack:function(g){var f=b.activeCard.stack,e=this;f.eachCard(function(h,j){h.index=j});Game.stationary(function(){g.eachCard(function(h){h.moveTo(e);h.index=-1});f.eachCard(function(h){h.index=-1})});f.updateCardsPosition();f.update();d.fire(e.field+":afterPush",e)},adjustRankHeight:function(){var f=this.cards,j,t=this.last(),r=Game.maxStackHeight(),q=0,h=0,k,u=0,p=b.Card,e=0,g=0,o,m,l,n;if(f.length<=1){return}for(l=0,n=f.length-1;l<n;l++){if(!f[l]){return}if(f[l].isFaceDown){q+=p.hiddenRankHeight;e++;u+=p.hiddenRankHeight}else{h+=p.rankHeight;g++;u+=p.rankHeight}}if(t){u+=t.height;k=r-t.height}if(u<=r){this.rankHeight=0;this.hiddenRankHeight=0;return}o=k*(q/(q+h))/e;m=k*(h/(q+h))/g;this.hiddenRankHeight=Math.floor(o);this.rankHeight=Math.floor(m)},first:function(){return this.cards[0]},last:function(){return this.cards.last()},index:function(){return Game[this.field].stacks.indexOf(this)},next:function(){return Game[this.field].stacks[this.index()+1]},setCardPosition:function(e){e.top=this.top;e.left=isNaN(this.left)?null:this.left},wrapperStyle:function(){return{left:Math.floor(this.left),top:Math.floor(this.top),width:Math.floor(d.Solitaire.Card.width),height:Math.floor(d.Solitaire.Card.height)}},updateStyle:function(){var e=this.node;e&&e.setStyles(this.wrapperStyle())},createNode:function(){var e=this.node;e=this.node=d.Node.create("<img class='stack'>").setAttribute("src",this.imageSrc()).setData("target",this).plug(d.Plugin.Drop,{useShim:true});this.updateStyle();b.container().append(e)},cleanup:function(){var e=this.node;e&&e.clearData().destroy(true);this.eachCard(function(f){f.destroyNode()})},updateDragGroups:function(){var j=b.activeCard,h=this.cards,g=this.last(),e,f=h.length-1;this.eachCard(function(i){i.node.drop.removeFromGroup("open")});if(j.validTarget(this)){if(g){g.node.drop.addToGroup("open")}this.node.drop.addToGroup("open")}else{this.node.drop.removeFromGroup("open")}},validCard:function(){return true},validProxy:function(e){return e&&e.validTarget(this)&&this.validCard(e)},update:function(){}};d.Solitaire.Animation={animate:true,dealing:false,duration:0.5,interval:20,queue:new d.AsyncQueue(),init:function(g,m,k){if(!this.animate){g.node.setStyles(m);g.positioned=true;setTimeout(function(){g.runCallback()},0);return}var f=g.node,e=this.queue,j=g.animSpeeds,n={top:f.getStyle("top"),left:f.getStyle("left")}.mapToFloat().mapAppend("px"),l=m.zIndex,i,h;if(n.top===m.top&&n.left===m.left){return}if(this.dealing){i=j.slow}else{if(!k||k.from===k.to||k.to==="waste"||k.to==="foundation"){i=j.fast}else{if(k.from==="deck"){i=j.slow}else{i=j.mid}}}f.setStyle("zIndex",500+l);delete m.zIndex;h=new d.Anim({node:f,from:n,to:m,easing:d.Easing.easeOut,duration:i});h.on("end",function(){g.positioned=true;f.setStyle("zIndex",l);g.runCallback()});e.add(function(){h.run()});e.run()},initQueue:function(){var e=this.queue;e.defaults.timeout=this.interval}};var c={stack:null,clear:function(){this.stack=[]},push:function(e){this.stack.push(e)},pop:function(){return this.stack.pop()||[]},undo:function(){var e;e=d.Array.unique(d.Array.map(this.pop(),this.act).flatten());d.Array.each(e,function(f){if(f){f.updateCardsPosition();f.update(true)}})},act:function(e){var i=e.from,f=e.card,h=f.stack,g=h.cards;if(i){if(i===f.stack){g[g.indexOf(f)]=null}else{g.deleteItem(f)}i.cards[e.index]=f;f.stack=i;b.container().append(f.node)}if("faceDown" in e){e.faceDown?f.faceUp(true):f.faceDown(true)}return[h,i]}}},"0.0.1",{requires:["dd","dd-plugin","dd-delegate","anim","async-queue","cookie","array-extras"]});YUI.add("solitaire-ios",function(e){if(!e.UA.ios){return}var o=e.Solitaire,q=o.scale,r=0,h=1,u={hspacing:0,vspacing:0,left:0,top:0,},c={scale:1,offset:60,maxStackHeight:155},v={Agnes:{offset:[null,5],maxStackHeight:260},FlowerGarden:{offset:[-60,5],maxStackHeight:235},Freecell:{scale:[1,0.93],offset:[35,5]},Golf:{scale:[1.1,1],offset:[45,8]},GClock:{scale:0.93,offset:5,maxStackHeight:130},Klondike:{offset:[null,5],maxStackHeight:[null,340]},MonteCarlo:{scale:[0.88,1],offset:[80,15]},Pyramid:{offset:20},Scorpion:{offset:5,maxStackHeight:[235,380]},Spider:{scale:[1.13,0.79],offset:[5,2],maxStackHeight:[160,340]},TriTowers:{scale:0.9,offset:10},Yukon:{scale:[0.95,1],offset:[50,5],maxStackHeight:[235,390]}},k={Agnes:function(){var z={hspacing:1.13};l(this,"Reserve",e.merge(z,{top:60}));l(this,"Tableau",e.merge(z,{top:145}));l(this,"Foundation",e.merge(z,{left:135}))},FlowerGarden:[function(){this.Card.rankHeight=15;l(this,"Reserve",{top:0,left:70});l(this,"Foundation",{top:0,left:470,hspacing:0,vspacing:1.1});l(this,"Tableau",{top:0,left:140});e.mix(this.Reserve.Stack,{setCardPosition:function(z){var A=this.cards.last(),C=A?A.top+11:this.top,B=this.left;z.left=B;z.top=C},update:o.noop},true)},function(){var z=o.FlowerGarden.Reserve.Stack.setCardPosition;return function(){l(this,"Tableau",{left:10,top:120});l(this,"Reserve",{left:17,top:60});l(this,"Foundation",{left:55,top:0,hspacing:1.5,vspacing:0});e.mix(this.Reserve.Stack,{setCardPosition:z,update:o.noop},true)}}()],Freecell:[x("Freecell",["Foundation","Reserve","Tableau"]),function(){var z={hspacing:1.05};l(this,"Tableau",z);l(this,"Reserve",z);l(this,"Foundation",e.merge(z,{left:157}))}],Golf:[x("Golf",["Tableau","Foundation"]),function(){l(this,"Tableau",{hspacing:1.1});l(this,"Foundation",{left:132})}],GClock:function(){l(this,"Foundation",{left:143,});l(this,"Tableau",{left:0,top:250,hspacing:1.05})},Klondike:[function(){x("Klondike","Foundation").call(this);x("Klondike","Tableau").call(this)},function(){e.mix(this.Foundation.stackConfig.layout,{left:135,hspacing:1.13},true);e.mix(this.Tableau.stackConfig.layout,{hspacing:1.13},true)}],MonteCarlo:function(){l(this,"Tableau",{cardGap:1.1,vspacing:1.05})},Pyramid:[function(){var z=x("Pyramid","Deck");var A=x("Pyramid","Waste");return function(){z.call(this);A.call(this);e.mix(this.Tableau.stackConfig.layout,{left:190,cardGap:1.1,hspacing:-0.55},true)}}(),function(){e.mix(this.Deck.stackConfig.layout,{left:-10,top:300,},true);e.mix(this.Waste.stackConfig.layout,{top:300,},true);e.mix(this.Tableau.stackConfig.layout,{left:120,cardGap:1.1,hspacing:-0.55},true)}],Scorpion:[function(){l(this,"Deck",{top:0,left:0});l(this,"Foundation",{top:0,left:420,hspacing:0,vspacing:1.1});l(this,"Tableau",{left:60,top:0,hspacing:1.13})},function(){l(this,"Deck",{left:10,top:0});l(this,"Foundation",{left:75,top:0,hspacing:1.5,vspacing:0});l(this,"Tableau",{left:0,top:60,hspacing:1.13})}],Spider:[function(){l(this,"Foundation",{left:94,hspacing:1.05});l(this,"Tableau",{top:65,hspacing:1.05})},function(){l(this,"Foundation",{left:62,hspacing:1});l(this,"Tableau",{hspacing:1})}],TriTowers:function(){e.mix(this.Tableau.stackConfig.layout,{hspacing:-0.5,rowGaps:[3,2,1,0],cardGap:1},true)},RussianSolitaire:[x("RussianSolitaire",["Tableau","Foundation"]),function(){l(this,"Tableau",{top:55,hspacing:1.13});l(this,"Foundation",{left:46,top:0,hspacing:1.5,vspacing:0})}],Yukon:[x("Yukon",["Tableau","Foundation"]),function(){l(this,"Tableau",{top:55,hspacing:1.13});l(this,"Foundation",{left:46,top:0,hspacing:1.5,vspacing:0})}]};v.FortyThieves=v.Spider1S=v.Spider2S=v.Spider;k.FortyThieves=k.Spider1S=k.Spider2S=k.Spider;v.WillOTheWisp=v.Spiderette=v.Klondike1T=v.Klondike;k.WillOTheWisp=k.Spiderette=k.Klondike1T=k.Klondike;v.RussianSolitaire=v.Yukon;e.mix(e.DD.DDM,{useHash:false,_pg_activate:o.noop,_pg_size:function(){if(this.activeDrag){this._pg.setStyles({width:"100%",height:"100%"})}}},true);e.DD.DDM.set("throttleTime",40);e.mix(e.DD.Drop.prototype,{_activateShim:function(){var z=e.DD.DDM;if(!z.activeDrag){return false}if(this.get("node")===z.activeDrag.get("node")){return false}if(this.get("lock")){return false}if(this.inGroup(z.activeDrag.get("groups"))){z._addValid(this);this.overTarget=false;if(!this.get("useShim")){this.shim=this.get("node")}this.sizeShim()}else{z._removeValid(this)}},_deactivateShim:function(){this.overTarget=false}},true);o.Statistics.winDisplay=function(){alert("You win!")};o.scale=o.noop;o.Card.ghost=false;o.Animation.animate=false;o.Card.base={theme:"mobile",hiddenRankHeight:3,rankHeight:15,width:40,height:50};function l(z,B,A){e.mix(z[B].stackConfig.layout,A,true)}function x(A,z){var B,C=function(D){return[D,e.merge(u,o[A][D].stackConfig.layout)]};B=e.Array.map(e.Array(z),C);return function(){var D=this;e.each(B,function(E){e.mix(D[E[0]].stackConfig.layout,E[1],true)})}}function b(){var z=o.name(),A;if(k.hasOwnProperty(z)){A=n(k[z]);A.call(o.game)}}function n(A){var z=window.innerWidth===480?r:h,B;if(!A.length){return A}B=A[z];return B?B:A[r]}function m(B){var z=o.name(),A=v[z],D=c[B],C=A?A[B]:D;return n(C?C:D)||D}function y(){q.call(o.game,m("scale"))}function i(){return m("offset")}function g(){return m("maxStackHeight")}function a(A){var z=A.target;if(z.hasClass("stack")||z.hasClass("card")){return}A.preventDefault()}function j(){function z(A){return{deleteSelector:function(C){var D=document.styleSheets[A],E,B;if(!D){return}E=Array.prototype.splice.call(D.rules,0);B=E.indexOf(E.filter(function(F){return F.selectorText===C})[0]);if(B!==-1){D.deleteRule(B)}}}}z(0).deleteSelector("#menu li:hover")}function f(z){if(z.target.test("#descriptions *")){return}z.preventDefault()}function t(){var B,E,C,G,A,F,D,z=function(){G.removeClass("show")};j();G=e.one("#menu");A=e.one("body");B=e.one("#undo");D=e.one("#social");F=e.Node.create("<nav id=navbar>");C=e.Node.create("<a id=show_menu class='button'>New Game</a>");E=e.Node.create("<li class=cancel><a id='cancel'>Cancel</a></li>");B.get("parentNode").remove();C.on("click",function(){G.addClass("show")});G.append(E);F.append(C);if(D){navigator.onLine?F.append(D):D.remove()}F.append(B.addClass("button"));A.append(F);e.on("click",z,["#cancel","#new_deal","#restart"]);o.Application.GameChooser.draggable=false;e.one("#game-chooser .titlebar").append(document.createTextNode("Games"));e.one("#game-chooser .close").append(document.createTextNode("Back"));e.delegate("touchstart",function(H){H.target.ancestor("li",true).addClass("hover")},"#descriptions","li");e.delegate("touchend",function(H){H.target.ancestor("li",true).removeClass("hover")},"#descriptions","li");e.on("gamechooser:select",function(H){H.choose();z()});e.on("gamechooser:hide",function(){w()});if(navigator.standalone){A.addClass("fullscreen")}o.Application.resizeEvent="orientationchange"}function d(A){var z=e.one("body"),C,B;if(A){C="portrait";B="landscape"}else{C="landscape";B="portrait"}z.removeClass(C).addClass(B)}function p(){var z=o.name(),B=window.innerWidth===480,A=g();d(B);b();o.offset={left:i(),top:10};o.maxStackHeight=function(){return A};y()}function w(){setTimeout(function(){scrollTo(0,0)},10)}e.on("beforeSetup",p);e.on("beforeResize",p);e.on("afterResize",w);e.on("load",w);e.on("touchstart",function(z){if(z.target._node===document.body){z.preventDefault()}},document);e.on("touchmove",f,document);e.on("domready",t)},"0.0.1",{requires:["solitaire","statistics"]});YUI.add("auto-stack-clear",function(b){var a=b.Solitaire;b.namespace("Solitaire.AutoStackClear");a.AutoStackClear.register=function(){b.on("solitaire|tableau:afterPush",function(e){d(e,c)})};function d(e,m){var k=e.cards,l,j,g,f,h;if(!k.length){return false}for(h=k.length-1,l=1,j=k[h].suit;h>=0&&l<14;h--,l++){g=k[h];if(g.isFaceDown||g.rank!==l||g.suit!==j){return false}}f=l===14;f&&typeof m==="function"&&m(e,h+1);return f}function c(e,i){var f,h=e.cards,g=h.length-i;f=b.Array.find(a.game.foundation.stacks,function(j){return !j.cards.length});a.stationary(function(){while(g){h.last().moveTo(f);g--}});e.updateCardsPosition()}},"0.0.1",{requires:["solitaire"]});YUI.add("auto-turnover",function(a){a.on("tableau:afterPop",function(b){a.Array.each(b.cards,function(c){if(c&&c.isFaceDown&&c.isFree()){c.faceUp()}})})},"0.0.1",{requires:["solitaire"]});YUI.add("solitaire-autoplay",function(h){h.namespace("Solitaire.Autoplay");var d=h.Solitaire,f=d.Autoplay,g=true,b=null,a=["Klondike","Klondike1T","FortyThieves","GClock","Freecell","FlowerGarden","Yukon"];h.on("endTurn",function(){if(!g||a.indexOf(d.game.name())===-1){return}if(b===null&&e()){h.fire("autoPlay")}});h.on("win",function(){clearInterval(b);b=null});h.on("autoPlay",function(){b=setInterval(c,130)});function c(){var i=false;d.game.eachStack(function(j){var k=j.field;if(i||k==="foundation"||k==="deck"){return}i=!j.eachCard(function(l){return !l.autoPlay()})})}function e(){var i=false;d.game.eachStack(function(j){var l=j.field,k=14,m;if(i||l!=="tableau"&&l!=="waste"){return}m=j.eachCard(function(n){if(n.rank>k||n.isFaceDown){i=true;return false}else{k=n.rank}})});return !i}h.mix(f,{enable:function(){g=true},disable:function(){g=false}})},"0.0.1",{requires:["solitaire"]});YUI.add("solitaire-background-fix",function(d){var c;d.on("load",b);d.on("resize",b);function b(){var g=a().get("winWidth"),e=a().get("winHeight"),f=document.body.style;if(!d.UA.mobile){a().setStyles({width:g,height:e})}if(f.backgroundSize===undefined&&f.MozBackgroundSize===undefined){a().setStyles({backgroundImage:"url(greentiled.jpg)",backgroundRepeat:"repeat"})}}function a(){if(!c){c=new d.Node(document.body)}return c}},"0.0.1",{requires:["solitaire"]});YUI.add("statistics",function(c){var g,i,l=true,o=window.localStorage,e=c.Solitaire,b=c.namespace("Solitaire.Statistics");if(!o){return}c.on("newGame",function(){if(g){d()}i=false;g=null});c.on("loadGame",function(){g=e.game.name();f();i=false});c.on("endTurn",function(){if(!g){g=e.game.name();f()}});c.on("win",function(){if(i||!l){return}var p=1000;g=null;i=true;k();j()});c.on("beforeSetup",function(){var p=c.one("#win_display");p&&p.remove();b.enable()});function j(){var q=500,r=900,p=900;Game.eachStack(function(t){t.eachCard(function(u){if(!u){return}var v=u.node;if(u!==t.last()){v.addClass("hidden");return}v.plug(c.Breakout,{columns:5});(function(w){setTimeout(function(){w.breakout.explode({random:0.65,duration:r})},q)})(v);q+=p})},"foundation");setTimeout(function(){b.winDisplay()},q+200)}function n(){var v={Agnes:"Agnes",Klondike:"Klondike",Klondike1T:"Klondike (Vegas style)",FlowerGarden:"Flower Garden",FortyThieves:"Forty Thieves",Freecell:"Freecell",Golf:"Golf",GClock:"Grandfather's Clock",MonteCarlo:"Monte Carlo",Pyramid:"Pyramid",RussianSolitaire:"Russian Solitaire",Scorpion:"Scorpion",Spider:"Spider",Spider1S:"Spider (1 Suit)",Spider2S:"Spider (2 Suit)",Spiderette:"Spiderette",WillOTheWisp:"Will O' The Wisp",TriTowers:"Tri Towers",Yukon:"Yukon"},u=m(o[e.game.name()+"record"]),t,r,q,p="<div id='win_display'>";t=u.streaks().last().length;r=u.wins().length;q=u.loses().length;p+="<p>You win! You're awesome.</p>";p+="<h2>"+v[e.game.name()]+" stats:</h2>";p+="<ul>";p+="<li>Current win streak: <span class='streak'>"+t+"</li>";p+="<li>Total wins: <span class='wins'>"+r+"</li>";p+="<li>Total loses: <span class='loses'>"+q+"</li>";p+="<div class=replay_options><button class=new_deal>New Deal</button><button class=choose_game>Choose Game</button></div>";p+="</ul></div>";return p}function h(r){var q=o.currentGame+"record",p=o[q]||"";p+=new Date().getTime()+"_"+r+"|";o[q]=p}function d(){h(0);a()}function k(){h(1);a()}function a(){o.removeItem("currentGame")}function f(){o.currentGame=e.game.name()}function m(q){function t(){var u=q.split("|");u.splice(u.length-1);return c.Array.map(u,function(v){v=v.split("_");return{date:new Date(v[0]),won:!!parseInt(v[1],10)}})}function r(u){return u.won}var p=t();return{streaks:function(){var v=[],u=null;c.Array.each(p,function(w){if(!w.won){u&&v.push(u);u=null}else{if(!u){u=[]}u.push(w)}});u&&v.push(u);return v},wins:function(){return c.Array.filter(p,r)},loses:function(){return c.Array.reject(p,r)}}}c.mix(b,{winDisplay:function(){var p=e.Application;c.one("body").append(n());c.on("click",function(){p.newGame()},c.one("#win_display .new_deal"));c.on("click",function(){p.GameChooser.show(true)},c.one("#win_display .choose_game"))},enable:function(){l=true},disable:function(){l=false}})},"0.0.1",{requires:["solitaire","array-extras","breakout"]});YUI.add("solver-freecell",function(a){a.namespace("Solitaire.Solver.Freecell");if(!(window.Worker&&window.ArrayBuffer&&window.Uint8Array)){return}var d=a.Solitaire,k=d.Solver.Freecell,b={s:0,h:1,c:2,d:3};function h(o){return o?o.rank<<2|b[o.suit]:0}function m(o){return o>>2}function e(o){return["s","h","c","d"][o&3]}function n(p,o){return o[0]-p[0]}function f(o){return a.Array.map(o.stacks,function(p){return p}).sort(function(r,p){var t=r.first(),q=p.first();return h(t)-h(q)})}function g(p){var o,q,r;r=a.Array.map(f(p.tableau),function(u){var t=[];u.eachCard(function(w,v){t[v]=h(w)});return[t,u.cards.length]});o=[];a.Array.forEach(f(p.reserve),function(u,t){o[t]=h(u.last())});q=[];a.Array.forEach(f(p.foundation),function(u,t){q[t]=h(u.last())});return{reserve:o,foundation:q,tableau:r}}function c(p,o){var u=o.source,r=o.dest,t,q={};t=u[1];p.eachStack(function(v){if(q.card){return}var w=v.last();if(!w){return}if(w.rank===m(t)&&w.suit===e(t)){q.card=w}},u[0]);t=r[1];p.eachStack(function(v){if(q.stack){return}var w=v.last();if(!(w||t)){q.stack=v}if(w&&(w.rank===m(t)&&w.suit===e(t))){q.stack=v}},r[0]);return q}function j(o,q){var p=a.one(o);if(p){q(p)}}var i={interval:500,timer:null,remainingMoves:null,init:function(o){var p=o;while(p){if(p.next){p.next.prev=p}p=p.next}this.remainingMoves=o},pause:function(){d.Autoplay.enable();window.clearTimeout(this.timer);this.timer=null;j("#solver_bar .pause",function(o){o.removeClass("pause");o.addClass("play")})},playCurrent:function(q){var o,r,p;if(!this.remainingMoves){return}o=c(q,this.remainingMoves);r=o.card;if(!r){return}p=r.stack;r.after(function(){p.updateCardsPosition();o.stack.updateCardsPosition()});r.moveTo(o.stack)},prev:function(o){var p=this.remainingMoves.prev;if(p){a.fire("undo",true);this.remainingMoves=p}},next:function(o){var q=this.remainingMoves,p=this.remainingMoves.next;d.Statistics.disable();this.playCurrent(o);if(p){this.remainingMoves=p}a.fire("endTurn",true)},play:function(q){var o,r,p;if(!this.remainingMoves){return}d.Autoplay.disable();j("#solver_bar .play",function(t){t.removeClass("play");t.addClass("pause")});this.next(q);this.timer=window.setTimeout(function(){this.play(q)}.bind(this),this.interval)}};var l={bar:null,indicator:null,indicatorTimer:null,indicatorInterval:750,delay:400,updateIndicator:function(q){var o=this.indicator,p,r;if(!o){return}q=((q||0)%4);r="Solving";for(p=0;p<q;p++){r+="."}o.set("text",r);this.indicatorTimer=window.setTimeout(this.updateIndicator.partial(q+1).bind(this),this.indicatorInterval)},stopIndicator:function(p){var o=this.indicator;window.clearTimeout(this.indicatorTimer);if(!o){return}if(p){o.set("text","Solution found");j("#solver_bar .controls",function(q){q.removeClass("hidden")})}else{o.set("text","Unable to find solution")}this.indicatorTimer=null},show:function(){if(a.one("#solver_bar")){return}var u=a.Node.create("<div id=solver_bar></div>"),o=a.Node.create("<span class=indicator>"),r=a.Node.create("<div class=fastforward>"),t=a.Node.create("<div class=rewind>"),v=a.Node.create("<div class=play>"),p=a.Node.create("<div class='controls hidden'>"),q;r.on("click",function(){i.next(Game)});t.on("click",function(){i.prev(Game)});v.on("click",function(){if(this.hasClass("play")){i.play(Game)}else{if(this.hasClass("pause")){i.pause()}}});p.append(t);p.append(v);p.append(r);u.append(o);u.append(p);a.one("body").append(u);this.indicator=o;this.bar=u},hide:function(){if(this.bar){this.bar.remove()}}};a.mix(k,{currentSolution:null,worker:null,attached:false,supportedGames:["Freecell"],isSupported:function(){return this.supportedGames.indexOf(Game.name())!==-1},enable:function(){if(this.isSupported()){this.createUI()}this.attachEvents()},disable:function(){if(this.worker){this.worker.terminate()}l.hide()},attachEvents:function(){if(this.attached){return}var o=i.pause.bind(i);a.on("afterSetup",function(){if(this.isSupported()){this.solve()}else{this.disable()}}.bind(this));a.on("endTurn",function(p){if(p||!this.isSupported()){return}this.solve()}.bind(this));a.on("autoPlay",function(){k.disable()});a.on("win",function(){k.disable()});document.documentElement.addEventListener("mousedown",function(p){if(p.target.className.match(/\bpause\b/)){return}o()},true);this.attached=true},createUI:function(){l.show()},stop:function(){if(this.worker){this.worker.terminate()}},solve:function(){this.stop();j("#solver_bar .controls",function(o){o.addClass("hidden")});this.currentSolution=null;this.worker=new Worker("js/solver-freecell-worker.js");this.worker.onmessage=function(p){var o=this.currentSolution=p.data.solution;i.init(o);if(o){l.stopIndicator(true)}else{l.stopIndicator(false)}}.bind(this);this.worker.postMessage({action:"solve",param:g(Game)});window.clearTimeout(l.indicatorTimer);l.indicatorTimer=window.setTimeout(l.updateIndicator.bind(l),l.delay)}});a.on("beforeSetup",k.enable.bind(k))},"0.0.1",{requires:["solitaire"]});var attempts=0,maxFastAttempts=150000;function GameState(c){if(!c){return}var b,a;this.reserve=new Uint8Array(c.reserve);this.foundation=new Uint8Array(c.foundation);this.tableau=[];for(b=0;b<c.tableau.length;b++){a=c.tableau[b];this.tableau[b]=[new Uint8Array(a[0]),a[1]]}}GameState.fromState=function(a){var b=new GameState();b.tableau=a.tableau;b.reserve=a.reserve;b.foundation=a.foundation;return b};GameState.prototype={reserve:null,foundation:null,tableau:null,rating:null,parentMove:null,parent:null,child:null,solved:function(){var c,a,b=this.foundation;for(c=0,a=4;c<a;c++){if((b[c]>>2)!==13){return false}}return true},eachTableau:function(e){var d,b,a,c=this.tableau;for(d=0,b=c.length;d<b;d++){a=c[d];e.call(this,a[0],a[1],d)}},validTarget:function(f,g,a){var c=g>>2,j=g&3,h,b,d,e;if(!g){return -1}if(a===undefined){a=0}else{a++}switch(f){case"foundation":for(d=0;d<4;d++){h=this.foundation[d];if((!h&&c===1)||(j===(h&3)&&c===(h>>2)+1)){return d}}break;case"reserve":for(d=0;d<4;d++){if(!this.reserve[d]){return d}}break;case"tableau":b=this.tableau;for(d=a,e=b.length;d<e;d++){h=b[d][0][b[d][1]-1];if(!b[d][1]||(((j&1)^(h&1))&&(c===(h>>2)-1))){return d}}break}return -1},move:function(b,d,c,a){var e=this.pop(b,d);this.push(c,a,e)},pop:function(g,b){var h,c,f,e,d,a;if(g==="reserve"||g==="foundation"){h=this[g][b];this[g]=new Uint8Array(this[g]);this[g][b]=0;return h}e=this.tableau;f=e[b][1];if(!f){return 0}h=e[b][0][f-1];this.copyTableau(b,f-1);return h},push:function(c,a,d){var b;if(!d){return}if(c==="reserve"||c==="foundation"){this[c]=new Uint8Array(this[c]);this[c][a]=d;return}b=this.tableau[a][1]+1;this.copyTableau(a,b);this.tableau[a][0][b-1]=d},copyTableau:function(b,g){var c=this.tableau,f=c[b][0],d=new Uint8Array(new ArrayBuffer(g)),e,a;for(e=0;e<g;++e){d[e]=f[e]}this.tableau=[];for(e=0,a=c.length;e<a;++e){if(e!==b){this.tableau[e]=c[e]}else{this.tableau[e]=[d,g]}}},sort:function(){Array.prototype.sort.call(this.reserve);Array.prototype.sort.call(this.foundation);this.tableau.sort(function(d,c){return d[0][0]-c[0][0]})},_serialized:null,serialize:function(){if(this._serialized!==null){return this._serialized}var d,c,b,a;this._serialized="";for(d=0;d<4;d++){this._serialized+=String.fromCharCode(this.reserve[d])}this._serialized+="_";for(d=0;d<4;d++){this._serialized+=String.fromCharCode(this.foundation[d])}this._serialized+="_";for(d=0;d<8;d++){a=this.tableau[d];for(c=0;c<a[1];c++){this._serialized+=String.fromCharCode(a[0][c])+"_"}}return this._serialized},rateMove:function(u,e,p,w){var b=1000,j=20,o=15,r=15,l=10,a=10,v=2,f=-1,h=-5,n=-10,k=0,g,c,m,t=false,q,d;if(p==="foundation"){k+=b}if(u==="tableau"){g=this.tableau[e];d=g[1];c=g[0][d-1];if(d===1){k+=r}for(q=d-2;q>=0;q--){if(this.validTarget("foundation",g[0][q])>-1){k+=o-(d-2-q)+(13-(g[0][q]>>2))}}if(this.validTarget("tableau",g[0][d-2])>-1){k+=l}}if(u==="reserve"){k+=a;c=this.reserve[e]}if(p==="tableau"){k+=v;g=this.tableau[w];d=g[1];for(q=d-1;q>=0;q--){if(this.validTarget("foundation",g[0][q])>-1){k+=h*(d-q)}}if(g[1]===0){if(u==="tableau"&&this.tableau[e][1]===1){return -1000}for(q=0;q<4;q++){m=this.reserve[q];if(((m>>2)===(c>>2)-1)&&((m&1)^(c&1))){k+=j+(m>>2);t=true}}for(q=0;q<8;q++){g=this.tableau[q];m=g[0][g[1]-1];if(((m>>2)===(c>>2)-1)&&((m&1)^(c&1))){k+=j+(m>>2);t=true}}if(!t){k+=n}}}if(p==="reserve"){k+=f}return k},transformParentMove:function(){var a=this.parentMove,b=this.parent;if(!(a&&b)){return}a.source[1]=b.lastCard(a.source[0],a.source[1]);a.dest[1]=b.lastCard(a.dest[0],a.dest[1])},lastCard:function(d,b){var a,c;switch(d){case"reserve":case"foundation":return this[d][b];case"tableau":a=this[d][b];c=a[1];return a[0][c-1]}},becomeChild:function(){var a=this.parent;if(!a){return}a.child=this;this.transformParentMove()}};function solve(d,t,m,k,j){var f,a=200,b,q,c,u,g,p,l,e,h,v=[],r=1,o=false,n;if(t>a){return a}if(d.solved()){d.becomeChild();return 0}for(n=0;n<4;n++){u=d.reserve[n];if(!u){continue}q=d.validTarget("foundation",u);if(q>-1){v.push({source:["reserve",n],dest:["foundation",q]});o=true}if(o){break}q=0;while((q=d.validTarget("tableau",u,q))>-1){v.push({source:["reserve",n],dest:["tableau",q]})}}e=d.tableau;for(n=0;n<e.length;n++){s=e[n][0];c=e[n][1];u=s[c-1];if(!u){continue}q=d.validTarget("foundation",u);if(q>-1){v.push({source:["tableau",n],dest:["foundation",q]});o=true}if(o){break}q=d.validTarget("reserve",u);if(q>-1){v.push({source:["tableau",n],dest:["reserve",q]})}q=0;while((q=d.validTarget("tableau",u,q))>-1){v.push({source:["tableau",n],dest:["tableau",q]})}}if(o){k=0}else{k++}for(n=0;n<v.length;n++){h=v[n];g=GameState.fromState(d);p=h.source[0];b=h.source[1];l=h.dest[0];q=h.dest[1];g.rating=g.rateMove(p,b,l,q);g.move(p,b,l,q);g.parentMove=h;g.parent=d;v[n]=g}v.sort(function(w,i){return i.rating-w.rating});if(k>=20){r=0.7}if(j&&(++attempts>maxFastAttempts)){r=0.001}for(n=0;n<v.length&&r===1;n++){h=v[n];if(f<t){break}if(m[h.serialize()]){if(j){break}else{continue}}m[h.serialize()]=true;f=solve(h,t+1,m,k,j)}if(f===0){d.becomeChild()}if(f===undefined){f=Math.ceil(t*r)}return f}function mapMoves(b){var d=b.child,a=null,c;if(!d){return}a=c=d.parentMove;while(d=d.child){c.next=d.parentMove;c=c.next}return a}function attemptSolution(c,b){var a=new GameState(c);attempts=0;solve(a,1,{},0,b);return mapMoves(a)}onmessage=function(d){var c,a,b=d.data;if(b.action==="solve"){a=attemptSolution(b.param,true);if(!a){a=attemptSolution(b.param,false)}self.postMessage({solution:a})}};YUI.add("agnes",function(f){function e(h,g){return(h+1)%13===g%13}function b(){return c.foundation.stacks[0].first().rank}var d=f.Solitaire,a=d.Klondike,c=d.Agnes=instance(a,{fields:["Foundation","Deck","Waste","Tableau","Reserve"],height:function(){return this.Card.base.height*5.6},maxStackHeight:function(){return this.Card.height*4.3},deal:function(){var g=this.deck.stacks[0],h=this.foundation.stacks[0];a.deal.call(this);g.last().faceUp().moveTo(h);this.turnOver()},redeal:d.noop,turnOver:function(){var g=this.deck.stacks[0],l=this.reserve.stacks,j=this.waste.stacks,k,m,h;if(g.cards.length<7){k=2;m=j}else{k=7;m=l}for(h=0;h<k;h++){g.last().faceUp().moveTo(m[h])}},Waste:instance(a.Waste,{stackConfig:{total:2,layout:{hspacing:1.5,top:0,left:0}},Stack:instance(d.Stack,{setCardPosition:function(g){var h=this.last(),j=this.top,i=h?h.left+d.Card.width*1.5:this.left;g.top=j;g.left=i}})}),Reserve:{field:"reserve",stackConfig:{total:7,layout:{hspacing:1.25,left:0,top:function(){return d.Card.height*4.4}}},Stack:instance(a.Stack,{images:{},setCardPosition:function(g){var h=this.last(),j=h?h.top+h.rankHeight:this.top,i=this.left;g.top=j;g.left=i}})},Card:instance(a.Card,{playable:function(){if(this.stack.field==="reserve"){return this.isFree()}else{return a.Card.playable.call(this)}},validTarget:function(g){var h=g.last();switch(g.field){case"tableau":if(!h){return e(this.rank,b())}else{return !h.isFaceDown&&h.color!==this.color&&e(this.rank,h.rank)}case"foundation":return this.validFoundationTarget(h);default:return false}},validFoundationTarget:function(g){if(!g){return this.rank===b()}else{return this.suit===g.suit&&this.rank%13===(g.rank+1)%13}}})})},"0.0.1",{requires:["klondike"]});YUI.add("golf",function(c){var b=c.Solitaire,a=c.Solitaire.Golf=instance(b,{fields:["Deck","Foundation","Tableau"],deal:function(){var g,d,h=this.tableau.stacks,e=this.deck,f=this.foundation.stacks[0],i;for(i=0;i<5;i++){for(d=0;d<7;d++){g=e.pop().faceUp();h[d].push(g)}}g=e.pop().faceUp();f.push(g);e.createStack()},turnOver:function(){var d=this.deck.stacks[0],e=this.foundation.stacks[0],f=d.last();f&&f.faceUp().moveTo(e)},isWon:function(){var d=true;this.eachStack(function(e){e.eachCard(function(f){if(f){d=false}return d})},"tableau");return d},height:function(){return this.Card.base.height*4},Deck:instance(b.Deck,{field:"deck",stackConfig:{total:1,layout:{hspacing:0,top:function(){return b.Card.height*3},left:0}},createStack:function(){var e,d;for(e=0,d=this.cards.length;e<d;e++){this.stacks[0].push(this.cards[e])}}}),Tableau:{field:"tableau",stackConfig:{total:7,layout:{hspacing:1.25,top:0,left:0}}},Foundation:{field:"foundation",stackConfig:{total:1,layout:{hspacing:0,top:function(){return b.Card.height*3},left:function(){return b.Card.width*3.75}}}},Events:instance(b.Events,{dragCheck:function(d){this.getCard().autoPlay();this._afterDragEnd();d.halt()}}),Card:instance(b.Card,{validTarget:function(d){if(d.field!=="foundation"){return false}var f=d.last(),e=Math.abs(this.rank-f.rank);return e===1},isFree:function(){return !this.isFaceDown&&this===this.stack.last()},}),Stack:instance(b.Stack,{images:{}})},true);c.Array.each(a.fields,function(d){a[d].Stack=instance(a.Stack)});c.mix(a.Tableau.Stack,{setCardPosition:function(d){var e=this.cards.last(),g=e?e.top+e.rankHeight:this.top,f=this.left;d.left=f;d.top=g}},true);c.mix(a.Deck.Stack,{setCardPosition:function(d){var e=this.last(),g,f,h;g=this.top;if(e){f=e.left+d.width*0.1;h=e.zIndex+1}else{f=this.left;h=0}d.top=g;d.left=f;d.zIndex=h}},true)},"0.0.1",{requires:["solitaire"]});YUI.add("klondike",function(c){var b=c.Solitaire,a=c.Solitaire.Klondike=instance(b,{fields:["Foundation","Deck","Waste","Tableau"],deal:function(){var g,e=6,d=0,f=this.deck,h=this.tableau.stacks;while(e>=0){g=f.pop().faceUp();h[6-e].push(g);for(d=7-e;d<7;d++){g=f.pop();h[d].push(g)}e--}f.createStack()},turnOver:function(){var d=this.deck.stacks[0],g=this.waste.stacks[0],j=a.Card.updatePosition,h,f,e;a.Card.updatePosition=b.noop;for(f=d.cards.length,e=f-3;f>e&&f;f--){d.last().faceUp().moveTo(g)}a.Card.updatePosition=j;g.eachCard(function(i){i.updatePosition()})},redeal:function(){var d=this.deck.stacks[0],e=this.waste.stacks[0];while(e.cards.length){e.last().faceDown().moveTo(d)}},Stack:instance(b.Stack),Foundation:{stackConfig:{total:4,layout:{hspacing:1.25,top:0,left:function(){return b.Card.width*3.75}}},field:"foundation",},Deck:instance(b.Deck,{stackConfig:{total:1,layout:{hspacing:0,top:0,left:0}},field:"deck"}),Waste:{stackConfig:{total:1,layout:{hspacing:0,top:0,left:function(){return b.Card.width*1.5}}},field:"waste",},Tableau:{stackConfig:{total:7,layout:{hspacing:1.25,top:function(){return b.Card.height*1.5},left:0}},field:"tableau",},Card:instance(b.Card,{playable:function(){switch(this.stack.field){case"tableau":return !this.isFaceDown;case"foundation":return false;case"waste":return this.isFree();case"deck":return true}},validFoundationTarget:function(d){if(!d){return this.rank===1}else{return d.suit===this.suit&&d.rank===this.rank-1}},validTarget:function(d){var e=d.last();switch(d.field){case"tableau":if(!e){return this.rank===13}else{return !e.isFaceDown&&e.color!==this.color&&e.rank===this.rank+1}case"foundation":return this.validFoundationTarget(e);default:return false}}})});c.Array.each(a.fields,function(d){a[d].Stack=instance(a.Stack)});c.mix(a.Stack,{validTarget:function(d){return d.field==="tableau"&&this.first().validTarget(d)}},true);c.mix(a.Tableau.Stack,{setCardPosition:function(d){var e=this.cards.last(),g=e?e.top+e.rankHeight:this.top,f=this.left;d.left=f;d.top=g}},true);c.mix(a.Waste.Stack,{setCardPosition:function(e){var g=this.cards,f=g.last(),d=this;c.Array.each(g.slice(-2),function(h,j){h.left=d.left;h.top=d.top});if(!g.length){e.left=d.left}if(g.length===1){e.left=d.left+0.2*e.width}else{if(g.length>1){f.left=d.left+0.2*e.width;f.top=d.top;e.left=d.left+0.4*e.width}}e.top=d.top}},true);c.mix(a.Deck.Stack,{createNode:function(){b.Stack.createNode.call(this);this.node.on("click",b.Events.clickEmptyDeck);this.node.addClass("playable")}},true)},"0.0.1",{requires:["solitaire"]});YUI.add("klondike1t",function(d){var c=d.Solitaire,b=c.Klondike,a=c.Klondike1T=instance(b,{redeal:c.noop,turnOver:function(){var e=this.deck.stacks[0],g=this.waste.stacks[0],f=e.last();f&&f.faceUp().moveTo(g)},Waste:instance(b.Waste,{Stack:instance(c.Stack)}),Deck:instance(b.Deck,{Stack:instance(b.Deck.Stack,{createNode:function(){b.Deck.Stack.createNode.call(this);this.node.removeClass("playable")}})})})},"0.0.1",{requires:["klondike"]});YUI.add("flower-garden",function(b){var a=b.Solitaire,c=b.Solitaire.FlowerGarden=instance(a,{fields:["Foundation","Reserve","Tableau"],deal:function(){var g,f=this.deck,e=this.reserve.stacks[0],d=0,h,j=this.tableau.stacks;for(h=0;h<36;h++){g=f.pop();j[d].push(g.faceUp());d++;if(d===6){d=0}}while(g=f.pop()){g.faceUp();e.push(g)}},height:function(){return this.Card.base.height*5.5},maxStackHeight:function(){return this.Card.height*4.4},Stack:instance(a.Stack),Foundation:{stackConfig:{total:4,layout:{hspacing:1.25,top:0,left:function(){return a.Card.width*4.25}}},field:"foundation",draggable:false},Reserve:{stackConfig:{total:1,layout:{hspacing:1.25,top:function(){return a.Card.height*4.5},left:function(){return a.Card.width*3}}},field:"reserve",draggable:true},Tableau:{stackConfig:{total:6,layout:{hspacing:1.25,top:function(){return a.Card.height*1.25},left:function(){return a.Card.width*3}}},field:"tableau",draggable:true},Card:instance(a.Card,{rankHeight:24,createProxyStack:function(){var d;switch(this.stack.field){case"foundation":this.proxyStack=null;break;case"tableau":return a.Card.createProxyStack.call(this);case"reserve":d=instance(this.stack);d.cards=[this];this.proxyStack=d;break}return this.proxyStack},moveTo:function(e){var h=this.stack.cards,f=h.indexOf(this),g,d;a.Card.moveTo.call(this,e);h.splice(f,0,null);for(g=f+1,d=h.length;g<d;g++){h[g].pushPosition()}h.splice(f,1)},validTarget:function(d){var e=d.last();switch(d.field){case"tableau":if(!e){return true}else{return e.rank===this.rank+1}break;case"foundation":if(!e){return this.rank===1}else{return e.suit===this.suit&&e.rank===this.rank-1}break;default:return false;break}},isFree:function(){if(this.stack.field==="reserve"){return true}else{return a.Card.isFree.call(this)}}})},true);b.Array.each(c.fields,function(d){c[d].Stack=instance(c.Stack)},true);b.mix(c.Stack,{images:{foundation:"freeslot.png",tableau:"freeslot.png"},validTarget:function(d){return d.field==="tableau"&&this.first().validTarget(d)},validCard:function(){return false}},true);b.mix(c.Tableau.Stack,{setCardPosition:function(d){var e=this.cards.last(),g=e?e.top+a.game.Card.rankHeight:this.top,f=this.left;d.left=f;d.top=g}},true);b.mix(c.Reserve.Stack,{setCardPosition:function(d){var e=this.cards.last(),g=e?e.left+a.Card.width*0.4:this.left,f=this.top;d.left=g;d.top=f},update:function(e){if(e){return}var d=this,f;b.Array.each(this.cards,function(g,h){f=d.left+h*g.width*0.4;if(f!==g.left){g.left=f;g.updatePosition()}})}},true)},"0.0.1",{requires:["solitaire"]});YUI.add("forty-thieves",function(c){var a=c.Solitaire,b=c.Solitaire.FortyThieves=instance(a,{fields:["Foundation","Deck","Waste","Tableau"],deal:function(){var f,d,h,e=this.deck,g=this.tableau.stacks;for(h=0;h<4;h++){for(d=0;d<10;d++){f=e.pop().faceUp();g[d].push(f)}}e.createStack()},redeal:function(){},turnOver:function(){var d=this.deck.stacks[0],g=this.waste.stacks[0],f,e;for(f=d.cards.length,e=f-1;f>e&&f;f--){d.last().faceUp().moveTo(g)}},Stack:instance(a.Stack),Foundation:{stackConfig:{total:8,layout:{hspacing:1.25,top:0,left:function(){return a.Card.width*3}}},field:"foundation",draggable:false},Deck:instance(a.Deck,{count:2,stackConfig:{total:1,layout:{hspacing:0,top:0,left:0}},field:"deck",init:function(){a.Deck.init.call(this);c.Array.each(this.cards,function(d){d.faceDown()})},createStack:function(){var e,d;for(e=this.cards.length-1;e>=0;e--){this.stacks[0].push(this.cards[e])}},}),Waste:{stackConfig:{total:1,layout:{hspacing:0,top:0,left:function(){return a.Card.width*1.25}}},field:"waste",draggable:true},Tableau:{stackConfig:{total:10,layout:{hspacing:1.31,top:function(){return a.Card.height*1.5},left:0}},field:"tableau",draggable:true},Card:instance(a.Card,{validTarget:function(d){var e=d.last();switch(d.field){case"tableau":if(!e){return this.rank===13}else{return !e.isFaceDown&&e.suit===this.suit&&e.rank===this.rank+1}break;case"foundation":if(!e){return this.rank===1}else{return e.suit===this.suit&&e.rank===this.rank-1}break;default:return false}}})});c.Array.each(b.fields,function(d){b[d].Stack=instance(b.Stack)});c.mix(b.Stack,{cssClass:"freestack",validTarget:function(d){return d.field==="tableau"&&this.first().validTarget(d)},validCard:function(){return false}},true);c.mix(b.Tableau.Stack,{setCardPosition:function(d){var e=this.cards.last(),g=e?e.top+e.rankHeight:this.top,f=this.left;d.left=f;d.top=g}},true);c.mix(b.Deck.Stack,{createDOMElement:function(){a.Stack.createDOMElement.call(this);this.node.on("click",a.Events.clickEmptyDeck)}},true);b.Foundation.Stack.cssClass="freefoundation"},"0.0.1",{requires:["solitaire"]});YUI.add("freecell",function(c){var b=c.Solitaire,a=c.Solitaire.Freecell=instance(b,{fields:["Foundation","Reserve","Tableau"],deal:function(){var e,d=0,f=this.tableau.stacks;while(e=this.deck.pop()){f[d].push(e.faceUp());d++;if(d===8){d=0}}},openSlots:function(g){var j=1,e=0,h,d,k=this.reserve.stacks,f=this.tableau.stacks;for(h=0;h<4;h++){d=k[h];!d.last()&&j++}for(h=0;h<8;h++){d=f[h];g!==d&&!f[h].last()&&e++}j*=Math.pow(2,e);return j},Stack:instance(b.Stack),height:function(){return this.Card.base.height*5},Foundation:{stackConfig:{total:4,layout:{hspacing:1.25,top:0,left:function(){return b.Card.width*6}}},field:"foundation",draggable:false},Reserve:{stackConfig:{total:4,layout:{hspacing:1.25,top:0,left:0}},field:"reserve",draggable:true},Tableau:{stackConfig:{total:8,layout:{hspacing:1.25,top:function(){return b.Card.height*1.5},left:0}},field:"tableau",draggable:true},Card:instance(b.Card,{playable:function(){switch(this.stack.field){case"reserve":return true;case"tableau":return this.createProxyStack();case"foundation":return false}},createProxyStack:function(){var d=b.Card.createProxyStack.call(this);this.proxyStack=d&&d.cards.length<=a.openSlots(d)?d:null;return this.proxyStack},validTarget:function(d){var e=d.last();switch(d.field){case"tableau":if(!e){return true}else{return e.color!==this.color&&e.rank===this.rank+1}break;case"foundation":if(!e){return this.rank===1}else{return e.suit===this.suit&&e.rank===this.rank-1}break;case"reserve":return !e;break}}})});c.Array.each(a.fields,function(d){a[d].Stack=instance(a.Stack)},true);c.mix(a.Stack,{validTarget:function(d){if(d.field!=="tableau"||!this.first().validTarget(d)){return false}return this.cards.length<=a.openSlots(d,this.last())}},true);c.mix(a.Tableau.Stack,{setCardPosition:function(d){var e=this.cards.last(),g=e?e.top+e.rankHeight:this.top,f=this.left;d.left=f;d.top=g}},true)},"0.0.1",{requires:["solitaire"]});YUI.add("grandfathers-clock",function(e){function b(h,g){var f=h.length;g%=f;if(g<0){g+=f}return h[g]}function d(f,h,g){if(f<=h){return f<=g&&g<=h}else{return f<=g||g<=h}}e.namespace("Solitaire.GClock");var c=e.Solitaire,a=e.Solitaire.GClock=instance(c,{fields:["Foundation","Tableau"],deal:function(){var k,o=this.deck,g=o.cards,j=[],p=["d","c","h","s"],q,n=0,m=51,l,f=this.foundation.stacks,h=this.tableau.stacks;while(m>=0){k=g[m];q=false;for(l=2;l<=13;l++){if(k.rank===l&&k.suit===b(p,l)){q=true;g.splice(m,1);j[l-2]=k.faceUp();break}}if(!q){h[n].push(k.faceUp());n=(n+1)%8}m--}for(m=0;m<12;m++){f[(m+2)%12].push(j[m])}},height:function(){return this.Card.base.height*6.7},Stack:instance(c.Stack),Foundation:{stackConfig:{total:12,layout:{hspacing:1.25,top:function(){return c.Card.height*3},left:function(){return c.Card.width*3.25}}},field:"foundation",draggable:false},Tableau:{stackConfig:{total:8,layout:{hspacing:1.25,top:0,left:function(){return c.Card.width*7.25}}},field:"tableau",draggable:true},Card:instance(c.Card,{createProxyStack:function(){var f;switch(this.stack.field){case"foundation":this.proxyStack=null;break;case"tableau":return c.Card.createProxyStack.call(this)}return this.proxyStack},validTarget:function(f){var h=f.last(),i,g;switch(f.field){case"tableau":if(!h){return true}else{return h.rank===this.rank+1}break;case"foundation":g=(f.index()+3)%12;i=h.rank;return h.suit===this.suit&&(h.rank+1)%13===this.rank%13&&d(f.first().rank,g,this.rank);break;default:return false;break}}})});e.Array.each(a.fields,function(f){a[f].Stack=instance(a.Stack)},true);e.mix(a.Stack,{validTarget:function(f){return f.field==="tableau"&&this.first().validTarget(f)},validCard:function(){return false}},true);e.mix(a.Tableau.Stack,{setCardPosition:function(f){var g=this.cards.last(),i=g?g.top+g.rankHeight:this.top,h=this.left;f.left=h;f.top=i}},true);e.mix(a.Foundation.Stack,{index:function(){return a.foundation.stacks.indexOf(this)},layout:function(g,f){var j=Math.sin(Math.PI*f/6)*c.Card.height*2.25,h=Math.cos(Math.PI*f/6)*c.Card.width*3;this.top=j+normalize(g.top);this.left=h+normalize(g.left)}},true)},"0.0.1",{requires:["solitaire"]});YUI.add("monte-carlo",function(c){var b=c.Solitaire,a=c.Solitaire.MonteCarlo=instance(b,{fields:["Foundation","Deck","Tableau"],createEvents:function(){b.createEvents.call(this);c.delegate("click",b.Events.clickEmptyDeck,b.selector,".stack");c.on("solitaire|endTurn",this.deckPlayable);c.on("solitaire|afterSetup",this.deckPlayable)},deckPlayable:function(){var e=false,d=Game.deck.stacks[0].node;Game.eachStack(function(f){if(!e&&c.Array.indexOf(f.cards,null)!==-1){e=true}},"tableau");if(e){d.addClass("playable")}else{d.removeClass("playable")}},deal:function(){var f,d,g,e=this.deck,h=this.tableau.stacks;for(d=0;d<5;d++){for(g=0;g<5;g++){f=e.pop().faceUp();h[d].push(f)}}e.createStack()},redeal:function(){var j=this.tableau.stacks,e=this.deck.stacks[0],k=c.Array.reduce(j,[],function(l,i){return l.concat(i.compact())}),d=k.length,f,h,g;c.Array.each(j,function(i){i.node.remove();i.cards=[];i.createNode()});for(g=h=0;g<d;g++){if(g&&!(g%5)){h++}j[h].push(k[g])}while(g<25&&e.cards.length){if(!(g%5)){h++}f=e.last().faceUp();f.moveTo(j[h]);f.node.setStyle("zIndex",100-g);g++}},height:function(){return this.Card.base.height*6},Stack:instance(b.Stack,{images:{deck:"freeslot.png"},updateDragGroups:function(){var d=b.activeCard;c.Array.each(this.cards,function(e){if(!e){return}if(d.validTarget(e)){e.node.drop.addToGroup("open")}else{e.node.drop.removeFromGroup("open")}})},index:function(){return 0}}),Events:instance(b.Events,{drop:function(h){var g=b.activeCard,d=b.game.foundation.stacks[0],f=h.drop.get("node").getData("target");if(!g){return}b.stationary(function(){f.moveTo(d);g.moveTo(d)});b.endTurn()}}),Foundation:{stackConfig:{total:1,layout:{spacing:0,top:0,left:function(){return b.Card.width*10.5}}},field:"foundation"},Deck:instance(b.Deck,{stackConfig:{total:1,layout:{spacing:0,top:0,left:function(){return b.Card.width*2}}},field:"deck",createStack:function(){var e,d;for(e=0,d=this.cards.length;e<d;e++){this.stacks[0].push(this.cards[e])}}}),Tableau:{stackConfig:{total:5,layout:{cardGap:1.25,vspacing:1.25,hspacing:0,top:0,left:function(){return b.Card.width*3.5}}},field:"tableau"},Card:instance(b.Card,{row:function(){return this.stack.index()},column:function(){return this.stack.cards.indexOf(this)},validTarget:function(d){if(!(this.rank===d.rank&&d.isFree())){return false}return Math.abs(d.row()-this.row())<=1&&Math.abs(d.column()-this.column())<=1},createProxyStack:function(){var d=null;if(this.isFree()){d=instance(this.stack);d.cards=this.proxyCards()}this.proxyStack=d;return this.proxyStack},proxyCards:function(){return[this]},isFree:function(){return this.stack.field==="tableau"},turnOver:function(){this.stack.field==="deck"&&b.game.redeal()}})});c.Array.each(a.fields,function(d){a[d].Stack=instance(a.Stack)});c.mix(a.Tableau.Stack,{deleteItem:function(d){var f=this.cards,e=f.indexOf(d);if(e!==-1){f[e]=null}},setCardPosition:function(d){var f=this.cards.last(),e=a.Tableau.stackConfig.layout,h=this.top,g=f?f.left+d.width*e.cardGap:this.left;d.left=g;d.top=h},compact:function(){var h=this.cards,e,g=[],f,d;for(f=0,d=h.length;f<d;f++){e=h[f];if(e){g.push(e);e.pushPosition()}}return g},index:function(){return b.game.tableau.stacks.indexOf(this)}},true);c.mix(a.Deck.Stack,{updateDragGroups:function(){var e=b.activeCard,d=this.last();if(!d){return}if(e.validTarget(d)){d.node.drop.addToGroup("open")}else{d.node.drop.removeFromGroup("open")}}},true)},"0.0.1",{requires:["solitaire","array-extras"]});YUI.add("pyramid",function(c){var a=c.Solitaire,b=c.Solitaire.Pyramid=instance(a,{fields:["Foundation","Deck","Waste","Tableau"],deal:function(){var f,d,g,e=this.deck,h=this.tableau.stacks;for(d=0;d<7;d++){for(g=0;g<=d;g++){f=e.pop().faceUp();h[d].push(f)}}e.createStack();e.last().faceUp()},turnOver:function(){var d=this.deck.stacks[0],e=this.waste.stacks[0];if(d.cards.length===1){return}d.last().moveTo(e)},height:function(){return this.Card.base.height*4.85},Stack:instance(a.Stack,{images:{},updateDragGroups:function(){var d=a.activeCard;c.Array.each(this.cards,function(e){if(!e){return}if(d.validTarget(e)){e.node.drop.addToGroup("open")}else{e.node.drop.removeFromGroup("open")}})}}),Events:instance(a.Events,{dragCheck:function(d){if(!a.game.autoPlay.call(this)){a.Events.dragCheck.call(this)}},drop:function(h){var g=a.activeCard,d=a.game.foundation.stacks[0],f=h.drop.get("node").getData("target");if(!g){return}a.stationary(function(){f.moveTo(d);g.moveTo(d)});a.endTurn()}}),Foundation:{stackConfig:{total:1,layout:{hspacing:0,top:0,left:function(){return a.Card.width*8}}},field:"foundation"},Deck:instance(a.Deck,{stackConfig:{total:1,layout:{hspacing:0,top:0,left:0}},field:"deck",createStack:function(){var e,d;for(e=0,d=this.cards.length;e<d;e++){this.stacks[0].push(this.cards[e])}}}),Waste:{stackConfig:{total:1,layout:{hspacing:0,top:0,left:function(){return a.Card.width*1.5}}},field:"waste"},Tableau:{stackConfig:{total:7,layout:{vspacing:0.6,hspacing:-0.625,cardGap:1.25,top:0,left:function(){return a.Card.width*5}}},field:"tableau"},Card:instance(a.Card,{validTarget:function(d){if(d.field==="foundation"){return this.isFree()&&this.rank===13}if(d.isFree()){return this.rank+d.rank===13}return false},createProxyNode:function(){return this.rank===13?"":a.Card.createProxyNode.call(this)},createProxyStack:function(){var d=null;if(this.isFree()){d=instance(this.stack);d.cards=this.proxyCards()}this.proxyStack=d;return this.proxyStack},proxyCards:function(){return[this]},isFree:function(){var d=this.stack,h=d.index(),f=d.cards.indexOf(this),e=a.game,g=d.next();if(d.field==="deck"||d.field==="waste"){return !this.isFaceDown}else{return !(this.stack.field==="foundation"||g&&(g.cards[f]||g.cards[f+1]))}},turnOver:function(){this.stack.field==="deck"&&!this.isFaceDown&&a.game.turnOver()}})});c.Array.each(b.fields,function(d){b[d].Stack=instance(b.Stack)});c.mix(b.Tableau.Stack,{deleteItem:function(d){var f=this.cards,e=f.indexOf(d);if(e!==-1){f[e]=null}},setCardPosition:function(d){var f=b.Tableau.stackConfig.layout,e=this.cards.last(),h=this.top,g=e?e.left+d.width*f.cardGap:this.left;d.left=g;d.top=h;d.zIndex=this.index()*10}},true);c.mix(b.Deck.Stack,{deleteItem:function(d){b.Stack.deleteItem.call(this,d);this.update()},update:function(d){var e=this.last();e&&e.faceUp(d)},updateDragGroups:function(){var e=a.activeCard,d=this.last();if(!d){return}if(e.validTarget(d)){d.node.drop.addToGroup("open")}else{d.node.drop.removeFromGroup("open")}}},true);b.Waste.Stack.updateDragGroups=b.Deck.Stack.updateDragGroups},"0.0.1",{requires:["solitaire"]});YUI.add("russian-solitaire",function(d){var b=d.Solitaire,c=b.Yukon,a=b.RussianSolitaire=instance(c,{Card:instance(c.Card)});a.Card.validTarget=function(e){var f=e.last();switch(e.field){case"tableau":if(!f){return this.rank===13}else{return !f.isFaceDown&&f.suit===this.suit&&f.rank===this.rank+1}case"foundation":if(!f){return this.rank===1}else{return f.suit===this.suit&&f.rank===this.rank-1}default:return false}}},"0.0.1",{requires:["yukon"]});YUI.add("scorpion",function(c){var b=c.Solitaire,a=b.Scorpion=instance(b,{fields:["Foundation","Deck","Tableau"],createEvents:function(){b.AutoStackClear.register();b.createEvents.call(this)},deal:function(){var f,d,h,e=this.deck,g=this.tableau.stacks;for(h=0;h<7;h++){for(d=0;d<7;d++){f=e.pop();if(!(h<3&&d<4)){f.faceUp()}g[d].push(f)}}e.createStack()},turnOver:function(){var e=this.deck.stacks[0],g=this.tableau.stacks,f,d;for(f=0;f<3;f++){e.last().faceUp().moveTo(g[f])}},height:function(){return this.Card.base.height*5.6},Stack:instance(b.Stack),Deck:instance(b.Deck,{stackConfig:{total:1,layout:{top:0,left:function(){return b.Card.width*9}},},field:"deck",createStack:function(){var e,d;for(e=this.cards.length-1;e>=0;e--){this.stacks[0].push(this.cards[e])}},}),Foundation:{stackConfig:{total:4,layout:{top:function(){return b.Card.height*1.1},left:function(){return b.Card.width*9},vspacing:1.1,}},field:"foundation"},Tableau:{stackConfig:{total:7,layout:{hspacing:1.25,top:0,left:0}},field:"tableau"},Card:instance(b.Card,{playable:function(){var d=this.stack.field;return d==="deck"||d==="tableau"&&!this.isFaceDown},validTarget:function(d){var e=d.last();if(d.field!=="tableau"){return false}if(!e){return this.rank===13}else{return !e.isFaceDown&&e.suit===this.suit&&e.rank===this.rank+1}}})});c.Array.each(a.fields,function(d){a[d].Stack=instance(a.Stack)});c.mix(a.Stack,{validTarget:function(d){return d.field==="tableau"&&this.first().validTarget(d)},validProxy:function(d){return true},validTarget:function(d){var g,f=this.cards,e;switch(d.field){case"tableau":return this.first().validTarget(d);break;case"foundation":g=this.last.rank;if(f.length!==13){return false}for(e=0;e<13;e++){if(f[e].rank!==g){return false}}return true;break}}},true);c.mix(a.Tableau.Stack,{setCardPosition:function(d){var e=this.cards.last(),g=e?e.top+e.rankHeight:this.top,f=this.left;d.left=f;d.top=g}},true)},"0.0.1",{requires:["auto-stack-clear"]});YUI.add("spider",function(d){var b=d.Solitaire,c=b.Spider=instance(b,{fields:["Foundation","Deck","Tableau"],createEvents:function(){b.AutoStackClear.register();b.createEvents.call(this)},deal:function(){var e=0,f=this.deck,g=this.tableau.stacks,h;for(h=0;h<5;h++){for(e=0;e<10;e++){if(e<4||h<4){g[e].push(f.pop())}}}for(e=0;e<10;e++){g[e].push(f.pop().faceUp())}f.createStack()},redeal:function(){},turnOver:function(){var f=this.deck.stacks[0],g,e;if(a()){return}this.eachStack(function(h){var i=f.last();if(i){i.faceUp().moveTo(h).after(function(){this.stack.updateCardsPosition()})}},"tableau")},Stack:instance(b.Stack),Foundation:{stackConfig:{total:8,layout:{hspacing:1.25,top:0,left:function(){return b.Card.width*2.5}}},field:"foundation",draggable:false},Deck:instance(b.Deck,{count:2,stackConfig:{total:1,layout:{hspacing:0,top:0,left:0}},field:"deck"}),Tableau:{stackConfig:{total:10,layout:{hspacing:1.25,top:function(){return b.Card.height*1.5},left:0}},field:"tableau",},Card:instance(b.Card,{playable:function(){var e=this.stack[this.index-1];switch(this.stack.field){case"tableau":return this.createProxyStack();case"deck":return !a();case"foundation":return false}},validTarget:function(e){if(e.field!=="tableau"){return false}var f=e.last();return !f||!f.isFaceDown&&f.rank===this.rank+1}})});function a(){return d.Array.some(Game.tableau.stacks,function(e){return !e.cards.length})}d.Array.each(c.fields,function(e){c[e].Stack=instance(c.Stack)});d.mix(c.Stack,{validCard:function(e){return e.suit===this.cards.last().suit},validTarget:function(e){switch(e.field){case"tableau":return this.first().validTarget(e);break;case"foundation":return this.cards.length===13;break}}},true);d.mix(c.Tableau.Stack,{setCardPosition:function(e){var f=this.cards.last(),h=f?f.top+f.rankHeight:this.top,g=this.left;e.left=g;e.top=h}},true)},"0.0.1",{requires:["auto-stack-clear"]});YUI.add("spider1s",function(b){var a=b.Solitaire.Spider1S=instance(b.Solitaire.Spider);a.Deck=instance(b.Solitaire.Spider.Deck,{suits:["s"],count:8})},"0.0.1",{requires:["spider"]});YUI.add("spider2s",function(b){var a=b.Solitaire.Spider2S=instance(b.Solitaire.Spider);a.Deck=instance(b.Solitaire.Spider.Deck,{suits:["s","h"],count:4})},"0.0.1",{requires:["spider"]});YUI.add("spiderette",function(e){var b=e.Solitaire,a=b.Klondike,d=b.Spider,c=e.Solitaire.Spiderette=instance(d,{height:a.height,deal:a.deal,Tableau:instance(d.Tableau,{stackConfig:a.Tableau.stackConfig}),Foundation:instance(d.Foundation,{stackConfig:a.Foundation.stackConfig}),Deck:instance(d.Deck,{count:1})})},"0.0.1",{requires:["klondike","spider"]});YUI.add("tri-towers",function(b){var a=b.Solitaire,c=b.Solitaire.TriTowers=instance(a,{fields:["Deck","Foundation","Tableau"],width:function(){return this.Card.base.width*15},height:function(){return this.Card.base.height*5},createEvents:function(){b.on("solitaire|endTurn",function(){var d=a.game.tableau.stacks,e;for(e=0;e<3;e++){b.fire("tableau:afterPop",d[e])}});a.createEvents.call(this)},deal:function(){var g,d,j=this.tableau.stacks,e=this.deck,f=this.foundation.stacks[0],h,k;for(d=0;d<4;d++){k=(d+1)*3;for(h=0;h<k;h++){g=e.pop();j[d].push(g);d===3&&g.faceUp()}}g=e.pop().faceUp();f.push(g);e.createStack()},turnOver:function(){var d=this.deck.stacks[0],e=this.foundation.stacks[0],f=d.last();f&&f.faceUp().moveTo(e)},isWon:function(){var d=true;this.eachStack(function(e){e.eachCard(function(f){if(f){d=false}return d})},"tableau");return d},Deck:instance(a.Deck,{field:"deck",stackConfig:{total:1,layout:{hspacing:0,top:function(){return a.Card.height*4},left:0}},createStack:function(){var e,d;for(e=0,d=this.cards.length;e<d;e++){this.stacks[0].push(this.cards[e])}}}),Tableau:{field:"tableau",stackConfig:{total:4,layout:{rowGaps:[3.75,2.5,1.25,0],cardGap:1.25,vspacing:0.6,hspacing:-0.625,top:0,left:function(){return a.Card.width*1.875}}}},Foundation:{field:"foundation",stackConfig:{total:1,layout:{hspacing:0,top:function(){return a.Card.height*4},left:function(){return a.Card.width*4}}}},Events:instance(a.Events,{dragCheck:function(d){this.getCard().autoPlay();this._afterDragEnd();d.halt()}}),Card:instance(a.Card,{validTarget:function(d){if(d.field!=="foundation"){return false}var e=d.last(),f=Math.abs(this.rank-e.rank);return f===1||f===12},playable:function(){var d=this.stack;return(d.field==="deck"&&this===d.last())||(this.isFree()&&this.validTarget(Game.foundation.stacks[0]))},isFree:function(){var d=this.stack,g=d.next(),h=this.tower(),e=d.cards.indexOf(this),f;if(d.field!=="tableau"){return false}if(!g){return true}for(f=0;f<2;f++){if(g.cards[e+h+f]){return false}}return true},tower:function(){var d=this.stack,e=d.cards.indexOf(this),f=d.index()+1;return Math.floor(e/f)}}),Stack:instance(a.Stack,{images:{}})},true);b.Array.each(c.fields,function(d){c[d].Stack=instance(c.Stack)});b.mix(c.Tableau.Stack,{deleteItem:function(d){var f=this.cards,e=f.indexOf(d);if(e!==-1){f[e]=null}},setCardPosition:function(f){var l=this.last(),j=this.top,e,i,k,h=c.Tableau.stackConfig.layout,d=h.rowGaps,g=h.cardGap;if(l){e=l.left+f.width*g;i=this.cards.length;k=this.index()+1;if(!(i%k)){e+=d[k-1]*f.width}}else{e=this.left}f.top=j;f.left=e;f.zIndex=this.index()*10}},true);b.mix(c.Deck.Stack,{setCardPosition:function(d){var e=this.last(),g,f,h;g=this.top;if(e){f=e.left+d.width*0.1;h=e.zIndex+1}else{f=this.left;h=0}d.top=g;d.left=f;d.zIndex=h}},true)},"0.0.1",{requires:["solitaire"]});YUI.add("will-o-the-wisp",function(c){var b=c.Solitaire,a=c.Solitaire.WillOTheWisp=instance(b.Spiderette,{deal:function(){var d=this.deck,e;for(e=0;e<3;e++){this.eachStack(function(f){var g=d.pop();if(e===2){g.faceUp()}f.push(g)},"tableau")}d.createStack()}})},"0.0.1",{requires:["spiderette"]});YUI.add("yukon",function(c){var a=c.Solitaire,b=a.Yukon=instance(a,{fields:["Foundation","Tableau"],deal:function(){var g,e=6,d=0,f=this.deck,h=this.tableau.stacks;while(e>=0){g=f.pop().faceUp();h[6-e].push(g);for(d=7-e;d<7;d++){g=f.pop();h[d].push(g)}e--}d=1;while(f.cards.length){g=f.pop().faceUp();h[d].push(g);d=(d%6)+1}},height:function(){return this.Card.base.height*4.8},Stack:instance(a.Stack),Foundation:{stackConfig:{total:4,layout:{vspacing:1.25,top:0,left:function(){return a.Card.width*9}}},field:"foundation",draggable:false},Tableau:{stackConfig:{total:7,layout:{hspacing:1.25,top:0,left:0}},field:"tableau",draggable:true},Card:instance(a.Card,{playable:function(){return this.stack.field==="tableau"&&!this.isFaceDown},validTarget:function(d){var e=d.last();switch(d.field){case"tableau":if(!e){return this.rank===13}else{return !e.isFaceDown&&e.color!==this.color&&e.rank===this.rank+1}break;case"foundation":if(!e){return this.rank===1}else{return e.suit===this.suit&&e.rank===this.rank-1}break;default:return false}}})});c.Array.each(b.fields,function(d){b[d].Stack=instance(b.Stack)});c.mix(b.Stack,{validTarget:function(d){return d.field==="tableau"&&this.first().validTarget(d)},validProxy:function(d){return true}},true);c.mix(b.Tableau.Stack,{setCardPosition:function(d){var e=this.cards.last(),g=e?e.top+e.rankHeight:this.top,f=this.left;d.left=f;d.top=g}},true)},"0.0.1",{requires:["solitaire"]});(function(){var f={name:"klondike",game:null},m=YUI({base:"js/yui-unpack/yui/build/"}),a,d={agnes:"Agnes",klondike:"Klondike",klondike1t:"Klondike1T","flower-garden":"FlowerGarden","forty-thieves":"FortyThieves",freecell:"Freecell",golf:"Golf","grandfathers-clock":"GClock","monte-carlo":"MonteCarlo",pyramid:"Pyramid","russian-solitaire":"RussianSolitaire",scorpion:"Scorpion",spider:"Spider",spider1s:"Spider1S",spider2s:"Spider2S",spiderette:"Spiderette","tri-towers":"TriTowers","will-o-the-wisp":"WillOTheWisp",yukon:"Yukon"},v=["auto-turnover","statistics","solver-freecell","solitaire-autoplay","solitaire-ios","solitaire-background-fix"],x=(function(){var C=null,z,B={position:"absolute",display:"none",backgroundColor:"#000",opacity:0.7,top:0,left:0,width:0,height:0,zIndex:1000,},A=function(){if(C===null){C=a.Node.create("<div>");C.setStyles(B);z=a.one("body").append(C)}return C};return{show:function(){var D=A();B.display="block";B.width=D.get("winWidth");B.height=D.get("winHeight");D.setStyles(B)},hide:function(){B.display="none";A().setStyles(B)}}}()),y={selected:null,fade:false,init:function(){this.refit()},refit:function(){var A=a.one("#game-chooser"),z=A.get("winHeight");A.setStyle("min-height",z)},show:function(z){if(!this.selected){this.select(f.name)}if(z){x.show();this.fade=true}a.one("#game-chooser").addClass("show");a.one("body").addClass("scrollable")},hide:function(){if(this.fade){x.hide()}a.one("#game-chooser").removeClass("show");a.fire("gamechooser:hide",this);a.one("body").removeClass("scrollable")},choose:function(){if(!this.selected){return}this.hide();c(this.selected)},select:function(z){var B=a.one("#"+z+"> div"),A=this.selected;if(A!==z){this.unSelect()}if(B){this.selected=z;new a.Node(document.getElementById(z)).addClass("selected")}if(A&&A!==z){a.fire("gamechooser:select",this)}},unSelect:function(){if(!this.selected){return}new a.Node(document.getElementById(this.selected)).removeClass("selected");this.selected=null}},n={dondorf:{sizes:[61,79,95,122],61:{hiddenRankHeight:7,rankHeight:25,dimensions:[61,95]},79:{hiddenRankHeight:10,rankHeight:32,dimensions:[79,123]},95:{hiddenRankHeight:12,rankHeight:38,dimensions:[95,148]},122:{hiddenRankHeight:15,rankHeight:48,dimensions:[122,190]}},snapToSize:function(z){var B,A=B.sizes;z=clamp(z,A[0],A[A.length-1])>>>0;while(a.Array.indexOf(A,z)===-1){z++}return z},load:function(z){var A=a.Solitaire,B=A.Card.base;if(!(z in this)){z="dondorf"}if(B.theme!==z){this.set(z,122)}},set:function(z,A){var B=this[z][A];a.mix(a.Solitaire.Card.base,{theme:z+"/"+A,hiddenRankHeight:B.hiddenRankHeight,rankHeight:B.rankHeight,width:B.dimensions[0],height:B.dimensions[1]},true)}};function u(){var A=v.slice(),z;for(z in d){if(d.hasOwnProperty(z)){A.unshift(z)}}return A}function e(z){a=z;b();a.on("domready",i)}function j(){y.select(this._node.id);y.choose()}function q(){a.on("click",p,a.one("#restart"));a.on("click",function(){y.show(false)},a.one("#choose_game"));a.on("click",function(){f.game.undo()},a.one("#undo"));a.on("click",h,a.one("#new_deal"));a.on("click",r,a.one(".chromestore"));a.delegate("click",j,"#descriptions","li");a.on("click",function(){y.hide()},a.one("#close-chooser"));a.one("document").on("keydown",function(z){z.keyCode===27&&y.hide()});a.on("afterSetup",function(){f.game.stationary(function(){w()})});o()}function o(){var B,z=250,A;if(window.addEventListener){A="addEventListener"}else{if(window.attachEvent){A="attachEvent"}}window[A](a.Solitaire.Application.resizeEvent,function(){clearTimeout(B);B=setTimeout(w,z)},false)}function w(){var A=f.game,D=A.container(),E=a.Solitaire.padding,F=a.Solitaire.offset,C=D.get("winWidth")-E.x,z=D.get("winHeight")-E.y,B=1;a.Solitaire.Application.windowHeight=z;B=Math.min((C-F.left)/A.width(),(z-F.top)/A.height());f.game.resize(B);y.refit()}function c(z){var A=1000*3600*24*14;f.name=z;f.game=a.Solitaire[d[z]];a.Cookie.set("options",z,{expires:new Date(new Date().getTime()+A)});h()}function k(){var z=a.Cookie.get("options");z&&(f.name=z);n.load("dondorf")}function i(){var z=a.Cookie.get("saved-game");q();k();t.preload();t.loaded(function(){g();if(z){l();f.game=a.Solitaire[d[f.name]];f.game.loadGame(z)}else{c(f.name)}});y.init()}function l(){a.all(".stack, .card").remove()}function p(){var A=a.Cookie.get("initial-game"),z=f.game;if(A){l();z.cleanup();z.loadGame(A);z.save()}}function h(){var z=f.game;l();z.cleanup();z.newGame()}function b(){a.Solitaire.Application={windowHeight:0,resizeEvent:"resize",GameChooser:y,newGame:h}}function r(){var z=1000*3600*24*365;a.one(".chromestore").addClass("hidden");a.Cookie.set("disable-chromestore-link",true,{expires:new Date(new Date().getTime()+z)})}function g(){if(a.UA.chrome&&!a.Cookie.get("disable-chromestore-link",Boolean)){a.one(".chromestore").removeClass("hidden")}}var t={loadingCount:0,loaded:function(z){if(this.loadingCount){setTimeout(function(){this.loaded(z)}.bind(this),100)}else{a.one(".loading").addClass("hidden");z();x.hide()}},load:function(A){var z=new Image;z.onload=function(){--this.loadingCount}.bind(this);z.src=A;this.loadingCount++},preload:function(){var A,z=["agnes","flower-garden","forty-thieves","freecell","gclock","golf","klondike1t","klondike","montecarlo","pyramid","scorpion","spider1s","spider2s","spiderette","spider","tritowers","will-o-the-wisp","yukon"];a.Array.each(["s","h","c","d"],function(B){for(A=1;A<=13;A++){this.load(a.Solitaire.Card.base.theme+"/"+B+A+".png")}},this);this.load(a.Solitaire.Card.base.theme+"/facedown.png");a.Array.each(z,function(B){this.load("layouts/mini/"+B+".png")},this);x.show();a.one(".loading").removeClass("hidden")}};m.use.apply(m,u().concat(e))}());